(()=>{"use strict";const e=!!new RegExp("ipad|iphone|android|pocket|palm|windows ce|windowsce|cellphone|opera mobi|ipod|small|sharp|sonyericsson|symbian|opera mini|nokia|htc_|samsung|motorola|smartphone|blackberry|playstation portable|tablet browser|webOS|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk","i").test(navigator.userAgent),t={data:()=>({vueCurrentUsername:"",vueCheckLichess:!1,vueLichessOrgPlayerNames:"",vueCheckChessCom:!1,vueChessComPlayerNames:"",vueAutoRefreshInterval:"",vueCheckDarkTheme:!1,vueArLichessPlayers:[],vueArChessComPlayers:[],vueArLichessPlayersBuf:[],vueArChessComPlayersBuf:[]}),methods:{vueScoreLichess(e){!function(e){!async function(e,t){if(-1===e.indexOf(t))return;$e(true,!0);const s=ze();let r=!1,n="";const a=Math.max.apply(null,e.map((e=>e.length)));for(let l of e)if(l!==t){const e=`${o}${t}/${l}`;try{const o=await fetch(e);if(o.ok){const e=await o.json();if(e&&!e.error){let r="",o=0,l="",i=0;const c=e.users;for(let e in c)e.toUpperCase()===t.toUpperCase()?(r=e,o=c[e]):(l=e,i=c[e]);const u=o-i;let m=(u>0?"+":"")+`${u}`;0===u||s||(m=`<span class="${u>0?"scorePlus":"scoreMinus"}">${m}</span>`);const g="_".repeat(a-l.length+2);n+=s?`X - ${l} ${g} ${o} : ${i} = ${m}\n`:`${r} - ${l} ${g}   ${o} : ${i} = ${m}\n`}}else r=!0,Ee(`status error: ${o.status} ${o.statusText} - ${e}`)}catch(t){r=!0,Ee(`error: ${t} - ${e}`)}}n+=r?'\nLichess says: "Too many requests from your ip-address."\nTry again later.':"",$e(true,!1),function(e="",t=""){ze()?alert((t?t+"\n\n":"")+e):(document.getElementById("modalDialogHead").innerHTML=De(t,"\n","<br>"),document.getElementById("modalDialogText").innerHTML=De(e,"\n","<br>"),O.showModal())}(n,s?`Score (X is ${t} ):`:"Score between players:")}(re(!0),e)}(e)},vueGroupAdd(){!function(){let e;if(10===j().length)return void alert("10 groups have already been created.\n\nThis is maximum !");const t=prompt("Input name of new group:","");null!==t&&""!==t&&(t.length>30?alert("The name must not exceed 30 symbols !"):(e=t.toUpperCase(),void 0===p.find((t=>t.name.toUpperCase()===e))?t.includes("!")?alert('The name must not include symbol "!".'):(p.push({name:t,lichessPlayerNames:s.vueLichessOrgPlayerNames,chessComPlayerNames:s.vueChessComPlayerNames}),I=t,R(document.getElementById("group"),I,I),de(),alert(`It's created group "${t}"\nwith the current lists of players.\n\nChange player lists !`)):alert(`Group "${t}" already exists.\n\nPlease enter an another name !`)))}()},vueGroupDel(){!function(){let e=I;const t=C.indexOf(e,0);if(F(t))return void alert(`Group "${e}" cannot be deleted !`);if(!confirm(`Delete group "${e}" ?`))return;const s=document.getElementById("group");s.options[t]=null,s.options[0].selected=!0,p=p.filter(((e,s,r)=>s!==t)),C=j(),I=C[0],ve(p[0].lichessPlayerNames),be(p[0].chessComPlayerNames),Q(),alert(`Group "${e}" is deleted.\n\nCurrent group is "${I}" !`)}()},vueGroupRestore(){!function(){let e=I;const t=C.indexOf(e,0);F(t)?confirm(`Restore group "${e}" ?`)&&(p[t]=d[t],I=p[t].name,C=j(),U(I),ve(d[t].lichessPlayerNames),be(d[t].chessComPlayerNames),Q(),alert(`Group "${e}" will be restored !`)):alert(`Group "${e}" cannot be restored !`)}()},vueGoUserMode(){!function(){document.querySelector("#errorMessage").textContent="",document.querySelector("#okMessage").textContent="",fe("main"),he(".sectionLoginArea");let e=localStorage.getItem("regtype");if(e=e||"","github"===M||"google"===M||"lichess"===M||"github"===e||"google"===e||"lichess"===e)document.getElementById("username").value="",document.getElementById("password").value="";else{const e=localStorage.getItem("username");document.getElementById("username").value=e||""}!function(){const e=s.vueCurrentUsername;return $&&-1===e.indexOf(a)}()?(document.getElementById("username").removeAttribute("disabled"),document.getElementById("password").removeAttribute("disabled"),fe("#buttonPostLogout"),he("#buttonPostLogin"),he("#buttonPostRegistration"),he(".referToLichess")):(document.getElementById("username").setAttribute("disabled",!0),document.getElementById("password").setAttribute("disabled",!0),he("#buttonPostLogout"),fe("#buttonPostLogin"),fe("#buttonPostRegistration"),fe(".referToLichess"))}()},vueRefresh(){Q()},vueOnClickCheckLichess(){ke(!we()),Z()},vueOnClickCheckChessCom(){Te(!Ne()),ee()},vueRefreshLichess(){Z()},vueRefreshChessCom(){ee()},vueOnchangeLichessPlayerNames(){!function(){let e=Ce();e=void 0===e?"":e,ve(e),H()}()},vueOnchangeChessComPlayerNames(){!function(){let e=Se();e=void 0===e?"":e,be(e),H()}()},vueGoSetMode(){fe("main"),he(".sectionSettingsArea")},vueSortBulletLichess(){Y(!0,"bullet")},vueSortBlitzLichess(){Y(!0,"blitz")},vueSortRapidLichess(){Y(!0,"rapid")},vueSortPuzzleLichess(){Y(!0,"puzzle")},vueSortRushLichess(){Y(!0,"rush")},vueSortBulletChessCom(){Y(!1,"bullet")},vueSortBlitzChessCom(){Y(!1,"blitz")},vueSortRapidChessCom(){Y(!1,"rapid")},vueSortPuzzleChessCom(){Y(!1,"puzzle")},vueSortRushChessCom(){Y(!1,"rush")},vueOnchangeAutoRefreshInterval(){!function(){let e=Ae();e=void 0===e?"":e,Le(e.trim())}()},vueOnClickSetTheme(){Ie(!Pe()),de(),Be()},vueClearSettings(){confirm("All settings will be cleared.\n\nAre you sure ?")&&(localStorage.clear(),Le(""),Ie(!1),E(),D(I),ve(p[0].lichessPlayerNames),be(p[0].chessComPlayerNames),function(){let e=document.getElementById("group").options;for(;e.length>y;)e[e.length-1]=null}(),w&&(w=!1,pe()),Q(),ye(),Be(),alert("All settings are cleared."))},vueRestoreStartGroups(){confirm("All Start-groups will be restored.\n\nAre you sure ?")&&(z(),function(){const e=document.getElementById("group");for(let t=0;t<y;t++)q(e,t,C[t],I)}(),Q(),alert("All Start-groups are restored."),ge())},vueGoMainModeFromSettings(){ge()},vueButtonChangeTables(){pe(),function(){w=!w;const e=w?"1":"";localStorage.setItem("isFirstChessCom",e)}()},vueGoMainModeFromUser(){me()}}},s=Vue.createApp(t).mount("#vue-mount"),r="https://lichess.org/api/user/",o="https://lichess.org/api/crosstable/",n="cors",a="  (disconnected)",l="@FIDE@",i="@STATUS-TEXT@",c="@STATUS-SYMBOL@",u=new Map([["player",0],["bullet",1],["blitz",2],["rapid",3],["puzzle",4],["rush",5]]),m="bovgit",g="Creator of this page :)",h=new Map([[m,g],["Thibault","Creator of Lichess.org"],["DrNykterstein","World champion\n\nMagnus Carlsen, Norway, FIDE 2882, GM"],["AvalonGamemaster","? Maxime Vachier-Lagrave, France, GM"]]),f=new Map([[m,g],["Erik","Creator of Chess.com"],["MagnusCarlsen","World champion"]]),d=[{name:"! FIDE top",lichessPlayerNames:"DrNykterstein Alireza2003 Bombegranate AnishGiri AvalonGamemaster",chessComPlayerNames:"MagnusCarlsen Firouzja2003 ChefsHouse FabianoCaruana LevonAronian LachesisQ AnishGiri Grischuk gmwso LyonBeast"},{name:"! custom",lichessPlayerNames:"Thibault Zhigalko_Sergei Benefactorr Chess-Network Crest64 Challenger_Spy ShahMatKanal Shuvalov Pandochka",chessComPlayerNames:"Erik Hikaru ChessQueen ChessNetwork ShahMatKanal"}],y=d.length;let p,C,v,S,b,A,L,P,I=d[0].name,w=!1,k="",N="",T="",B="",$="",M="";b=document.querySelector("#InputOrder1"),A=document.querySelector("#InputOrder2"),L=document.querySelector("#LichessTables"),P=document.querySelector("#ChessComTables"),e&&(document.querySelector("#bodyStyle").setAttribute("class","mobileStyle"),document.querySelector(".projectName").setAttribute("class","projectName projectNameDifMobile"),document.querySelector("#modalDialog").setAttribute("class","modalDialogMobileStyle")),document.querySelector("#group").onchange=()=>function(){const e=document.getElementById("group");let t=p.find((t=>t.name===e.value));t&&(I=t.name,ve(t.lichessPlayerNames),be(t.chessComPlayerNames)),Q()}();const O=document.getElementById("modalDialog");function E(){p=[];for(let e=0;e<y;e++)p.push("");z()}function z(){for(let e=0;e<y;e++)p[e]=JSON.parse(JSON.stringify(d[e]));I=p[0].name,C=j(),ve(p[0].lichessPlayerNames),be(p[0].chessComPlayerNames)}function D(e){const t=document.getElementById("group");for(let s=0;s<C.length;s++)R(t,C[s],e)}function R(e,t,s){const r=document.createElement("option");x(r,t,s),e.appendChild(r)}function x(e,t,s){e.value=t,e.innerHTML="<strong><em>"+t+"</em></strong>",e.value===s&&(e.selected=!0)}function q(e,t,s,r){x(e[t],s,r)}function U(e){q(document.getElementById("group"),C.indexOf(e,0),e,e)}function H(){const e=p.find((e=>e.name===I));e.lichessPlayerNames=s.vueLichessOrgPlayerNames,e.chessComPlayerNames=s.vueChessComPlayerNames}function j(){return p.map((e=>e.name))}function F(e){return e>-1&&e<y}async function G(){const e=J();if(!e)return;_("User login...");const t=await fetch("/loginAJAX",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:e});if(t.ok){const e=await t.json();if(Ee("jsonObj: "+new Date),Ee(e),e.errorMsg){const t=e.errorMsg.message;return void X(t?`Login error: ${t}`:"Login unknown error")}let s,r,o,n,a,l,i,c;return _("User logged in."),s=e.usernameAfterLogin,s&&(r=e.regtypeAfterLogin,W(s,r),localStorage.setItem("username",$),localStorage.setItem("regtype",M),r=e.LichessOrgPlayerNamesAfterLogin,r&&(ve(r),localStorage.setItem("LichessOrgPlayerNames",r)),o=e.ChessComPlayerNamesAfterLogin,o&&(be(o),localStorage.setItem("ChessComPlayerNames",o)),n=!1,s=e.isDarkThemeAfterLogin,s&&(n="1"===s,Ie(n),localStorage.setItem("DarkThemeChecked",n?"1":"0"),Be()),a=!1,s=e.CheckLichessAfterLogin,s&&(a="1"===s,ke(a),localStorage.setItem("LichessChecked",a?"1":"0")),l=!1,s=e.CheckChessComAfterLogin,s&&(l="1"===s,Te(l),localStorage.setItem("ChessComChecked",l?"1":"0")),i=!1,s=e.isFirstChessComAfterLogin,s&&(i="1"===s,i!==w&&(w=i,pe()),localStorage.setItem("isFirstChessCom",i?"1":"0")),c=e.autoRefreshIntervalAfterLogin,c&&(Le(c),localStorage.setItem("AutoRefreshInterval",c)),(r||o||n||a||l||i)&&Q()),void me()}X("Error occured during login.")}function J(){let e;if(e=document.querySelector("#username").value.trim(),!e)return alert("Fill username !"),"";if("anonym"===e.toLowerCase())return alert("This username is unacceptable !"),"";if(e.indexOf(" ")>=0)return alert("Username should not contain a space !"),"";let t=e;if(e=document.querySelector("#password").value,!e)return alert("Fill password !"),"";if(e.indexOf(" ")>=0)return alert("Password should not contain a space !"),"";let s=e;return"username="+encodeURIComponent(t)+"&password="+encodeURIComponent(s)}function X(e){document.querySelector("#errorMessage").textContent=e,document.querySelector("#okMessage").textContent=""}function _(e){document.querySelector("#errorMessage").textContent="",document.querySelector("#okMessage").textContent=e}function W(e,t){$=e||"",M=t||"",M="userpass"===M?"":M,s.vueCurrentUsername=$}function Y(e,t){if(""===t)return;let r,o,n,a,l,i,c,m,g=function(e){const t=e?".TBodyLichess":".TBodyChessCom";return document.querySelector(t)}(e),h=g.rows.length;if(0===h)return;let f=new Array(h);for(r=0;r<h;r++)for(a=g.rows[r].cells,n=a.length,f[r]=new Array(n),o=0;o<n;o++)l=0===o?e?s.vueArLichessPlayers[r].playerName:s.vueArChessComPlayers[r].playerName:a[o].textContent,l=l.trim(),0===o?f[r][o]=l:(i=0,""!==l&&(i=parseInt(l,10),!isNaN(i)&&Number.isInteger(i)||(i=0)),f[r][o]=i);f.sort((function(e,s){let r=u.get(t);return s[r]-e[r]})),K(e),c=".THead"+t+(e?"Lichess":"ChessCom"),l=document.querySelector(c).textContent,m=l.slice(-1),"↑"!==m&&(document.querySelector(c).textContent+="↑"),e?(k=c,T=t):(N=c,B=t);const d=[];let y,p;for(r=0;r<h;r++)for(y=0;y<h;y++)if(p=e?s.vueArLichessPlayers[y].playerName:s.vueArChessComPlayers[y].playerName,f[r][0]===p){d.push(e?s.vueArLichessPlayers[y]:s.vueArChessComPlayers[y]);break}for(r=0;r<h;r++)e?s.vueArLichessPlayers[r]=d[r]:s.vueArChessComPlayers[r]=d[r]}function K(e){let t=e?k:N;if(""!==t){let e=document.querySelector(t).textContent;"↑"===e.slice(-1)&&(document.querySelector(t).textContent=e.slice(0,-1))}}function V(e){K(e),e?(k="",T=""):(N="",B="")}function Q(){let e=!0;V(e),se(e),e=!1,V(e),se(e),de()}function Z(){te(!0)}function ee(){te(!1)}function te(e){V(e),se(e),de()}function se(t){const o=t?"#LichessTables":".TableChessComRatings",a=document.querySelector(o);!function(e){return e?we():Ne()}(t)?"none"!==a.style.display&&(a.style.display="none"):("block"!==a.style.display&&(a.style.display="block"),async function(t){let o=re(t);0!==o.length&&($e(t,!0),t?(s.vueArLichessPlayersBuf.length=0,await async function(t){await async function(e){const t=e.join(","),r=await fetch("https://lichess.org/api/users",{method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},body:t});if(!r.ok)return void Ee(`status error: ${r.status} ${r.statusText} - getProfilesAfterFetchFromLichess`);const o=Oe(),n=await r.json();e.forEach(((e,t)=>{const r=e.toUpperCase(),a=n.find((e=>e.username.toUpperCase()===r));if(a){let t,r=ie(0,a,"title");r=void 0===r?"":r+" ";let n="",l=h.get(e);l&&(n=l+"\n\n");const c=ce(0,a,"profile","firstName"),u=ce(0,a,"profile","lastName"),m=ce(0,a,"profile","location"),g=ce(0,a,"profile","fideRating"),f=ce(0,a,"profile","bio"),d=ce(0,a,"profile","links");let y="";t=ie(0,a,"createdAt"),t&&(y=new Date(t).getFullYear());let p="";t=ie(0,a,"seenAt");let C="lastOnline";t&&(p=Me(t),new Date(t)<o&&(C="lastOnlineBeforeToday"));const v=(c?c+" ":"")+(u||"")+(m?(c||u?", ":"")+m:"")+(g?", FIDE "+g:"")+(r&&!l?", "+r:"");n+=v+(v?"\n":"")+(y?"reg. "+y:"")+(p?"\nlast online "+p:"")+"\n"+i+(f?"\n"+De(f,'"',"'"):"")+(d?"\n"+d:"");let S='<a href="https://lichess.org/@/'+e+'" target="_blank" title="'+n+'">@STATUS-SYMBOL@<span class="playerTitle">'+r+" </span><strong>"+e+"</strong></a>"+(p?'<br><span class="'+C+'">'+p+"</span>":"");const b=ue(0,a,"perfs","bullet","rating"),A=ue(0,a,"perfs","blitz","rating"),L=ue(0,a,"perfs","rapid","rating"),P=ue(0,a,"perfs","puzzle","rating"),I=ue(0,a,"perfs","storm","score");s.vueArLichessPlayersBuf.push({playerHTML:S,playerName:e,bullet:b,blitz:A,rapid:L,puzzle:P,rush:I})}else Ee(`${e} - lichess, response.json error`),s.vueArLichessPlayersBuf.push({playerHTML:"<em>"+e+"</em>",playerName:e,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})}))}(t),await async function(e){(await async function(e){let t=[];const s=e.join(",");let r=fetch(`https://lichess.org/api/users/status?ids=${s}`,{mode:n}).then((e=>200!=e.status?null:e.json()),(e=>null));return t.push(r),await Promise.all(t)}(e))[0].forEach((t=>{const r=t.name;e.forEach(((e,o)=>{if(r.toUpperCase()===e.toUpperCase()){const e=ie(0,t,"patron"),r=ie(0,t,"online"),n=ie(0,t,"playing"),a=ie(0,t,"streaming");let l=e?"Patron. ":"";l+=r||a||n?"Now: ":"",l+=n?"playing, ":"",l+=a?"streaming, ":"",l+=!r||a||n?"":"online, ",l=l.trim(),","===l[l.length-1]&&(l=l.slice(0,l.length-1)+".");let u=l?l+"\n":"",m=s.vueArLichessPlayersBuf[o].playerHTML.replace(i,u);l="",a&&(l='<span class="statusStreaming">&#127908;</span>'),n&&(l+='<span class="statusPlaying">&#9679;</span>'),!r||a||n||(l='<span class="statusOnline">&#10004;</span>'),m=m.replace(c,l),s.vueArLichessPlayersBuf[o].playerHTML=m}}))}))}(t),await async function(t){(await async function(e){let t=[];for(let s of e){let e=fetch(`${r}${s}/activity`,{mode:n}).then((e=>200!=e.status?null:e.json()),(e=>null));t.push(e)}return await Promise.all(t)}(t)).forEach(((t,r)=>{if(t&&0!==t.length)for(let o of["bullet","blitz","rapid","puzzle"]){const n="bullet"===o||"blitz"===o||"rapid"===o,a=n?"games":"puzzles",l=n?o:"score",i="rp",c=t.find((e=>!!(e[a]&&e[a][l]&&e[a][l][i])));if(c){const t=c[a][l][i].after,n=c[a][l][i].before;if(t&&n){const a=t-n;if(0!==a){const t=e?"mobileRatingPlus":"ratingPlus";let n=(a>0?"+":"")+`${a}`;n=a>0?"<sup>"+n+"</sup>":"<sub>"+n+"</sub>",n=`<span class="${a>0?t:"ratingMinus"}">${n}</span>`;const l=s.vueArLichessPlayersBuf[r];l[o]=`${l[o]}${n}`,s.vueArLichessPlayersBuf[r]=l}}}}}))}(t),function(e){e.forEach(((e,t)=>{let r=s.vueArLichessPlayersBuf[t].playerHTML.replace(i,"");r=r.replace(c,""),s.vueArLichessPlayersBuf[t].playerHTML=r}))}(t)}(o)):(s.vueArChessComPlayersBuf.length=0,s.vueArChessComPlayersBuf=s.vueArChessComPlayersBuf.map(((e,t)=>{s.vueArChessComPlayersBuf[t]={playerHTML:"",playerName:"",bullet:"",blitz:"",rapid:"",puzzle:"",rush:""}})),await async function(e){let t=!0;await oe(e,t),t=!1,await oe(e,t)}(o)),function(e,t){if(0===t.length)return;const r=e?s.vueArLichessPlayersBuf.length:s.vueArChessComPlayersBuf.length,o=[];for(let n=0;n<t.length;n++){const a=t[n];if(""!==a)for(let t=0;t<r;t++)if(a===(e?s.vueArLichessPlayersBuf[t].playerName:s.vueArChessComPlayersBuf[t].playerName)){o.push(e?s.vueArLichessPlayersBuf[t]:s.vueArChessComPlayersBuf[t]);break}}e?s.vueArLichessPlayers=[...o]:s.vueArChessComPlayers=[...o]}(t,o),$e(t,!1))}(t))}function re(e){let t=function(e){return e?Ce():Se()}(e),s=t.split(" ");return s=s.filter((e=>""!==e)),s}async function oe(e,t){let s=[...e];const r=s.length;if(0===r)return;const o=t?"profile":"statistics";let n=200;for(let a=0;a<6;a++){let l=[...s];l=l.map((e=>!1)),a>0&&(n+=100,Ee(`step ${a+1} / 6, chess.com ${o}, ${s.length} el. from ${r}, delay ${n}`),await new Promise(((e,t)=>setTimeout(e,n))));let i=!0;const c=t?"":"/stats";if((await ne(!1,s,c)).forEach(((r,n)=>{const a=s[n];let c=!1;t?c=ae(r,a,e):null!==r&&(le(r,e.indexOf(a),a),c=!0),c?l[n]=!0:(i=!1,Ee(`not read ${o}: ${a}, chess.com`))})),i)break;s=s.filter(((e,t)=>!l[t]))}}async function ne(e,t,s=""){let o=[];for(let a of t)if(""!==a){let t=fetch(`${e?r:"https://api.chess.com/pub/player/"}${a}${s}`,{mode:n}).then((e=>200!=e.status?null:e.json()),(e=>null));o.push(t)}return await Promise.all(o)}function ae(e,t,r){let o=!1,n="",a="",i="",c="",u="",m="";const g=Oe();let h=f.get(t);if(h&&(m=h+"\n\n"),n=ie(0,e,"url"),""===n||null==n)i="<em>"+t+"</em>";else{h=ie(0,e,"title"),a=void 0===h?"":h+" ";const s=ie(0,e,"name"),r=ie(0,e,"location");h=ie(0,e,"joined"),h&&(c=new Date(1e3*h).getFullYear()),h=ie(0,e,"last_online");let f="lastOnline";h&&(u=Me(1e3*h),new Date(1e3*h)<g&&(f="lastOnlineBeforeToday")),m+=(s||"")+(r?", "+r:""),m+=l+(a?", "+a:""),m+=(m&&m!==l?"\n":"")+"reg. "+c+"\nlast online "+u,i='<a href="'+n+'" target="_blank" title="'+m+'"><span class="playerTitle">'+a+" </span><strong>"+t+"</strong></a>"+(u?'<br><span class="'+f+'">'+u+"</span>":""),o=!0}return r.forEach(((e,r)=>{e===t&&(s.vueArChessComPlayersBuf[r]={playerHTML:i,playerName:t,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})})),o}function le(e,t,r){const o=ie(0,e,"fide"),n=o?`, FIDE ${o}`:"",a=s.vueArChessComPlayersBuf[t].playerHTML.replace(l,n),i=ue(0,e,"chess_bullet","last","rating"),c=ue(0,e,"chess_blitz","last","rating"),u=ue(0,e,"chess_rapid","last","rating"),m=ue(0,e,"tactics","highest","rating"),g=ue(0,e,"puzzle_rush","best","score");s.vueArChessComPlayersBuf[t]={playerHTML:a,playerName:r,bullet:i,blitz:c,rapid:u,puzzle:m,rush:g}}function ie(e,t,s){let r="";try{r=t[s]}catch(e){}return r}function ce(e,t,s,r){let o="";try{o=t[s][r]}catch(e){}return o}function ue(e,t,s,r,o){let n="";try{n=t[s][r][o]}catch(e){}return n}function me(){fe(".sectionLoginArea"),he("main")}function ge(){let e=Ae();if(""!==e){let t=parseInt(e,10);if(isNaN(t)||!(Number.isInteger(t)&&t>=0&&t<=9999))return void alert("Interval must be between 0 and 9999 !");e=t.toString(10)}Le(e),localStorage.setItem("AutoRefreshInterval",e),ye(),fe(".sectionSettingsArea"),he("main")}function he(e){document.querySelector(e).style.display="block"}function fe(e){document.querySelector(e).style.display="none"}function de(){let e,t,s;localStorage.setItem("groupObjs",JSON.stringify(p)),localStorage.setItem("currentGroupName",I),e=Ce(),s=localStorage.getItem("LichessOrgPlayerNames"),s=null===s?"":s,t=e.trim()!==s.trim(),localStorage.setItem("LichessOrgPlayerNames",e),e=Se(),s=localStorage.getItem("ChessComPlayerNames"),s=null===s?"":s,t=t||e.trim()!==s.trim(),localStorage.setItem("ChessComPlayerNames",e),e=we()?"1":"0",t=t||e!==localStorage.getItem("LichessChecked"),localStorage.setItem("LichessChecked",e),e=Ne()?"1":"0",t=t||e!==localStorage.getItem("ChessComChecked"),localStorage.setItem("ChessComChecked",e),e=Pe()?"1":"0",t=t||e!==localStorage.getItem("DarkThemeChecked"),localStorage.setItem("DarkThemeChecked",e)}function ye(){clearInterval(v);let e=Ae();if(""!==e){let t=parseInt(e,10);0!==t&&(v=setInterval(Q,60*t*1e3))}else v=void 0}function pe(){let e;A.parentNode.insertBefore(A,b),e=b,b=A,A=e,P.parentNode.insertBefore(P,L),e=L,L=P,P=e}function Ce(){return s.vueLichessOrgPlayerNames.trim()}function ve(e){s.vueLichessOrgPlayerNames=e.trim()}function Se(){return s.vueChessComPlayerNames.trim()}function be(e){s.vueChessComPlayerNames=e.trim()}function Ae(){return s.vueAutoRefreshInterval.trim()}function Le(e){s.vueAutoRefreshInterval=e?e.trim():""}function Pe(){return s.vueCheckDarkTheme}function Ie(e){s.vueCheckDarkTheme=e}function we(){return s.vueCheckLichess}function ke(e){s.vueCheckLichess=e}function Ne(){return s.vueCheckChessCom}function Te(e){s.vueCheckChessCom=e}function Be(){const e=Pe(),t="black",s="white";e?(document.body.style.backgroundColor=t,document.body.style.color=s):(document.body.style.backgroundColor=s,document.body.style.color=t);const r=e?"1":"0";localStorage.setItem("DarkThemeChecked",r)}function $e(e,t){const s=e?"#LichessWait":"#ChessComWait";let r;e&&we()&&(r=document.querySelector("#elemTextLichessOrgPlayerNames")),!e&&Ne()&&(r=document.querySelector("#elemTextChessComPlayerNames")),r&&(t?(document.querySelector(s).setAttribute("class","showBlock"),r.style.backgroundColor="#ffe4b5",r.setAttribute("class","inputText waitAnimation")):(r.style.backgroundColor="white",r.setAttribute("class","inputText waitAnimation2"),document.querySelector(s).setAttribute("class","hiddenBlock")),document.querySelector("#msgHintEdit").setAttribute("class","msgHint msgHintWaitAnimation"),document.querySelector("#msgHintScore").setAttribute("class","msgHint msgHintWaitAnimation"))}function Me(e){let t=new Date;const s=new Date(t).setHours(0,0,0,0);t-=864e5;const r=new Date(t).setHours(0,0,0,0),o=new Date(e);let n=o.toLocaleString();return n=n.slice(0,-3),o>=s?n="today"+n.slice(10,17):o>=r&&(n="yesterday"+n.slice(10,17)),n}function Oe(){const e=new Date-864e5;return new Date(e).setHours(0,0,0,0)}function Ee(e){const t=(new Date).toLocaleString();console.log(`${t} - ${e}`)}function ze(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function De(e,t,s){return e.replace(new RegExp(t,"g"),s)}document.getElementById("modalDialogHide").onclick=()=>O.close(),document.querySelector("#buttonPostRegistration").onclick=()=>{!async function(){const e=J();if(!e)return;_("User registration...");const t=await fetch("/registrationAJAX",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:e});if(t.ok){const e=await t.json();if(Ee("jsonObj: "+new Date),Ee(e),e.errorMsg){let t=e.errorMsg.message;return void(t?X(`Registration error: ${t}`):(t=e.errorMsg,X(t?`Reg.error: ${t}`:"Registration unknown error")))}_("User registered.");const s=e.usernameAfterRegistration;return s?(alert("User <"+s+"> registered."),void G()):void X("Impossible to login after registration (username is empty).")}X("Error occured during registration.")}()},document.querySelector("#buttonPostLogin").onclick=()=>{G()},document.querySelector("#buttonPostLogout").onclick=()=>{!async function(){_(`${$} logout...`);const e=await fetch("/logoutAJAX");if(e.ok){const t=(await e.json()).msg;return _(`${$} logged out. (${t})`),W("",""),localStorage.setItem("username",""),localStorage.setItem("regtype",""),void me()}X("Error occured during logout.")}()},document.addEventListener("keydown",(function(e){"Enter"!==e.key&&13!==e.keyCode||Q()})),E(),function(){let e;e=localStorage.getItem("currentGroupName"),e||(e=I),""!==e&&(I=e),e=localStorage.getItem("groupObjs"),e&&""!==e&&"undefined"!==e?(p=JSON.parse(e),C=j(),e=localStorage.getItem("LichessOrgPlayerNames"),ve(e),e=localStorage.getItem("ChessComPlayerNames"),be(e)):(e=localStorage.getItem("LichessOrgPlayerNames"),e||(e=d[0].lichessPlayerNames),""!==e&&ve(e),e=localStorage.getItem("ChessComPlayerNames"),e||(e=d[0].chessComPlayerNames),""!==e&&be(e)),e=localStorage.getItem("LichessChecked"),e=null===e?"1":e,ke("1"===e),e=localStorage.getItem("ChessComChecked"),e=null===e?"1":e,Te("1"===e),e=localStorage.getItem("isFirstChessCom"),w="1"===e,e=localStorage.getItem("AutoRefreshInterval"),Le(e),e=localStorage.getItem("DarkThemeChecked"),Ie("1"===e)}(),D(I),U(I),w&&pe(),ye(),Be(),window.addEventListener("orientationchange",(function(){window.orientation}),!1),S=!0,function(){const e=new URLSearchParams(window.location.search);let t,r,o,n,l,i,c,u,m;if(r=e.get("afterSendUserSettingsToServer"),r)return t=localStorage.getItem("username"),r=localStorage.getItem("regtype"),void(t&&W(t,r));if(m=e.get("errorMsgAfterRegistration"),m)return W("",""),void alert("errorMsgAfterRegistration: "+m);const g=e.get("usernameAfterRegistration");if(g){const t=e.get("passwordAfterRegistration");t?(alert("User <"+g+"> registered."),function(e,t,s){let r=document.createElement("form");r.action=e,r.method="POST",r.innerHTML='<input name="username" value="'+t+'"><input name="password" value="'+s+'">',document.body.append(r),r.submit(),r.remove()}("/login",g,t)):alert("Impossible to login after registration (password is empty).")}else{if(m=e.get("errorMsgAfterLogin"),!m)return t=e.get("usernameAfterLogin"),t?(r=e.get("regtypeAfterLogin"),W(t,r),localStorage.setItem("username",$),localStorage.setItem("regtype",M),r=e.get("LichessOrgPlayerNamesAfterLogin"),r&&(ve(r),localStorage.setItem("LichessOrgPlayerNames",r)),o=e.get("ChessComPlayerNamesAfterLogin"),o&&(be(o),localStorage.setItem("ChessComPlayerNames",o)),n=!1,t=e.get("isDarkThemeAfterLogin"),t&&(n="1"===t,Ie(n),localStorage.setItem("DarkThemeChecked",n?"1":"0"),Be()),l=!1,t=e.get("CheckLichessAfterLogin"),t&&(l="1"===t,ke(l),localStorage.setItem("LichessChecked",l?"1":"0")),i=!1,t=e.get("CheckChessComAfterLogin"),t&&(i="1"===t,Te(i),localStorage.setItem("ChessComChecked",i?"1":"0")),c=!1,t=e.get("isFirstChessComAfterLogin"),t&&(c="1"===t,c!==w&&(w=c,pe()),localStorage.setItem("isFirstChessCom",c?"1":"0")),u=e.get("autoRefreshIntervalAfterLogin"),u&&(Le(u),localStorage.setItem("AutoRefreshInterval",u)),void((r||o||n||l||i||c)&&(Q(),S=!1))):(t=e.get("usernameAfterLogout"),t?(W("",""),localStorage.setItem("username",""),void localStorage.setItem("regtype","")):(t=localStorage.getItem("username"),r=localStorage.getItem("regtype"),void(t&&(W(t,r),r="PageAlreadyWasVisitedAtThisBrowserTab",o=sessionStorage.getItem(r),o||(sessionStorage.setItem(r,1),async function(){let e={username:$};const t=await fetch("/isUserLoggedAJAX",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(e)});if(t.ok){const e=await t.json();Ee("isUserLoggedAJAX: jsonObj: "+new Date),Ee(e);const r=e.isUserLoggedAJAX;return r?void("0"===r&&(s.vueCurrentUsername=$+a)):void Ee("Error occured during afterIsUserLoggedAJAX.")}Ee("Error occured during isUserLoggedAJAX.")}())))));alert("errorMsgAfterLogin: "+m)}}(),S&&Q()})();