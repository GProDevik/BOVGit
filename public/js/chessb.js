(()=>{"use strict";let e="EN",t="RU",s=e;const n=!!new RegExp("ipad|iphone|android|pocket|palm|windows ce|windowsce|cellphone|opera mobi|ipod|small|sharp|sonyericsson|symbian|opera mini|nokia|htc_|samsung|motorola|smartphone|blackberry|playstation portable|tablet browser|webOS|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk","i").test(navigator.userAgent),o={data:()=>({vueCurrentUsername:"",vueCheckLichess:!1,vueLichessOrgPlayerNames:"",vueCheckChessCom:!1,vueChessComPlayerNames:"",vueAutoRefreshInterval:"",vueCheckDarkTheme:!1,vueArLichessPlayers:[],vueArChessComPlayers:[],vueArLichessPlayersBuf:[],vueArChessComPlayersBuf:[]}),methods:{vueScoreLichess(e){!function(e){!async function(e,t){if(-1===e.indexOf(t))return;ze(true,!0);let s=!1,n="";const o=Math.max.apply(null,e.map((e=>e.length)));for(let l of e)if(l!==t){const e=`${i}${t}/${l}`;try{const l=await fetch(e);if(l.ok){const e=await l.json();if(e&&!e.error){let s="",l=0,a="",r=0;const i=e.users;for(let e in i)e.toUpperCase()===t.toUpperCase()?(s=e,l=i[e]):(a=e,r=i[e]);const c=l-r;let u=(c>0?"+":"")+`${c}`;0!==c&&(u=`<span class="${c>0?"scorePlus":"scoreMinus"}">${u}</span>`),n+=`${s} - ${a} ${"_".repeat(o-a.length+2)}   ${l} : ${r} = ${u}\n`}}else s=!0,$e(`status error: ${l.status} ${l.statusText} - ${e}`)}catch(t){s=!0,$e(`error: ${t} - ${e}`)}}let l;ze(true,!1),Oe()?(n+=s?'\nLichess says: "Too many requests from your ip-address."\nTry again later.':"",l="Score between players:"):(n+=s?'\nLichess сообщает: "Слишком много запросов с вашего ip-адреса."\nПовторите запрос немного позже.':"",l="Счет между игроками:"),function(e="",t=""){const s=Me(t,"\n","<br>");!function(e="",t=""){!function(){let e=document.createElement("div");e.id="cover-div",document.body.style.overflowY="hidden",document.body.append(e)}();let s=document.getElementById("prompt-form"),n=document.getElementById("prompt-form-container");function o(e){document.getElementById("cover-div").remove(),document.body.style.overflowY="",n.style.display="none",document.onkeydown=null}document.getElementById("prompt-message").innerHTML=e,document.getElementById("prompt-head").innerHTML=t,s.cancel.onclick=function(){o()},document.onkeydown=function(e){"Escape"==e.key&&o()};let l=s.elements[s.elements.length-1],a=s.elements[0];l.onkeydown=function(e){if("Tab"==e.key&&!e.shiftKey)return a.focus(),!1},a.onkeydown=function(e){if("Tab"==e.key&&e.shiftKey)return l.focus(),!1},n.style.display="block",s.elements.cancel.focus()}(Me(e,"\n","<br>"),s)}(n,l)}(oe(!0),e)}(e)},vueGroupAdd(){!function(){let e,t;if(D().length===k){const e=Oe()?"10 groups have already been created.\n\nThis is maximum !":"10 групп уже создано.\n\nЭто максимум !";return void alert(e)}t=Oe()?"Input name of new group:":"Введите имя новой группы:";const s=prompt(t,"");if(null!==s&&""!==s){if(s.length>A)return t=Oe()?"The name must not exceed 30 symbols !":"Длина имени не должна превышать 30 символов !",void alert(t);if(e=s.toUpperCase(),void 0!==q.find((t=>t.name.toUpperCase()===e)))return t=Oe()?`Group "${s}" already exists.\n\nPlease enter an another name !`:`Группа "${s}" уже есть.\n\nПожалуйста, введите другое имя !`,void alert(t);if(s.includes("!"))return t=Oe()?'The name must not include symbol "!".':'Имя не должно содержать символ  "!".',void alert(t);q.push({name:s,lichessPlayerNames:a.vueLichessOrgPlayerNames,chessComPlayerNames:a.vueChessComPlayerNames}),P=s,w=D(),j(document.getElementById("group"),P,P),ye(),H(),t=Oe()?`It's created group "${s}"\nwith the current lists of players.\n\nChange player lists !`:`Создана группа "${s}"\nс текущими списками игроков.\n\nВнесите свои изменения в списки созданной группы!`,alert(t),function(e){a.vueLichessOrgPlayerNames=e}(Ce()+"\n"),document.querySelector("#elemLichessPlayerNames").focus()}}()},vueGroupDel(){!function(){let e,t=P;const s=w.indexOf(t,0);if(V(s))return e=Oe()?`Group "${t}" cannot be deleted !`:`Группу "${t}" нельзя удалять !`,void alert(e);if(e=Oe()?`Delete group "${t}" ?`:`Удалить группу "${t}" ?`,!confirm(e))return;const n=document.getElementById("group");n.options[s]=null,n.options[0].selected=!0,q=q.filter(((e,t,n)=>t!==s)),w=D(),P=w[0],H(),be(q[0].lichessPlayerNames),Se(q[0].chessComPlayerNames),X(),e=Oe()?`Group "${t}" is deleted.\n\nCurrent group is "${P}".`:`Группа "${t}" удалена.\n\nТекущая группа теперь: "${P}".`,alert(e)}()},vueGoUserMode(){!function(){clearMessages(),pe("main"),de(".sectionLoginArea");let e=localStorage.getItem("regtype");if(e=e||"","github"===e||"google"===e||"lichess"===e)document.getElementById("username").value="",document.getElementById("password").value="";else{const e=localStorage.getItem("username");document.getElementById("username").value=e||""}isUserLogged()?(document.getElementById("username").setAttribute("disabled",!0),document.getElementById("password").setAttribute("disabled",!0),de("#buttonPostLogout"),pe("#buttonPostLogin"),pe("#buttonPostRegistration"),pe(".referToLichess")):(document.getElementById("username").removeAttribute("disabled"),document.getElementById("password").removeAttribute("disabled"),pe("#buttonPostLogout"),de("#buttonPostLogin"),de("#buttonPostRegistration"),de(".referToLichess"))}()},vueRefresh(){X()},vueOnClickCheckLichess(){Ne(!we()),ee()},vueOnClickCheckChessCom(){Te(!Ie()),te()},vueRefreshLichess(){ee()},vueRefreshChessCom(){te()},vueOnchangeLichessPlayerNames(){J()},vueOnchangeChessComPlayerNames(){!function(){let e=ve();e=void 0===e?"":e,Se(e),Y()}()},vueGoTables(){pe(".sectionSettingsArea"),de("main")},vueGoSetMode(){pe("main"),de(".sectionSettingsArea")},vueSortBulletLichess(){W(!0,"bullet")},vueSortBlitzLichess(){W(!0,"blitz")},vueSortRapidLichess(){W(!0,"rapid")},vueSortPuzzleLichess(){W(!0,"puzzle")},vueSortRushLichess(){W(!0,"rush")},vueSortBulletChessCom(){W(!1,"bullet")},vueSortBlitzChessCom(){W(!1,"blitz")},vueSortRapidChessCom(){W(!1,"rapid")},vueSortPuzzleChessCom(){W(!1,"puzzle")},vueSortRushChessCom(){W(!1,"rush")},vueOnchangeAutoRefreshInterval(){!function(){let e=Le();e=void 0===e?"":e,Pe(e.trim())}()},vueOnClickSetTheme(){Ae(!ke()),ye(),Be()},vueClearSettings(){!function(){let t;t=Oe()?"All settings will be cleared.\n\nAre you sure ?":"Все настройки будут сброшены.\n\nВы уверены ?",confirm(t)&&(localStorage.clear(),Pe(""),Ae(!1),G(),U(P),function(){let e=document.getElementById("group").options;for(;e.length>L;)e[e.length-1]=null}(),$&&($=!1,ge()),X(),fe(),Be(),t=Oe()?"All settings are cleared.":"Все настройки сброшены.",alert(t),s=e,document.getElementById("langSelect").value=s,Re())}()},vueRestoreStartGroups(){!function(){let e;e=Oe()?"All Start-groups will be restored.\n\nAre you sure ?":"Во всех стартовых группах\nбудут восстановлены начальные значения.\n\nВы уверены ?",confirm(e)&&(F(),function(){const e=document.getElementById("group");for(let t=0;t<L;t++)K(e,t,w[t],P)}(),X(),e=Oe()?"All Start-groups are restored.":"Все стартовые группы восстановлены.",alert(e),he())}()},vueGoMainModeFromSettings(){he()},vueButtonChangeTables(){ge(),function(){$=!$;const e=$?"1":"";localStorage.setItem("isFirstChessCom",e)}()},vueGoMainModeFromUser(){pe(".sectionLoginArea"),de("main")}}},l=Vue.createApp(o);l.component("vue-component-tips",{template:'\n    <fieldset id="tipsEN" class="showBlock">\n    <legend><em><strong>Tips</strong></em></legend>\n    <ul>\n      <li><span class="click">Click</span> on the <span class="dotted">button "↺"</span>\n        to refresh all tables\n      </li>\n      <li><span class="click">Click</span> on the <span class="dotted">"↑↓" button</span> to change the order of tables</li>\n      <li><span class="click">Click</span> on the <span class="dotted">heading "♞ Lichess"</span> to refresh the\n        Lichess table and sort by player list</li>\n      <li><span class="click">Click</span> on the <span class="dotted">heading "♟ Chess.com"</span> to refresh the\n        Chess.com table and sort by player list</li>\n      <li><span class="click">Click</span> on <span class="dotted">any other heading</span> to sort by rating\n      </li>\n      <li>\n        If you <span class="click">hover the mouse over </span><span class="dotted">the player in table</span>,\n        a pop-up window will appear with an <span class="dotted">information about player</span>\n      </li>\n      <li>For Lichess: there are several types of <span class="dotted">player status</span> to the left of his\n        name in table:\n        <ul>\n          <li><span class="statusOnline">&#10004;</span> - online</li>\n          <li><span class="statusPlaying">&#9679;</span> - playing</li>\n          <li><span class="statusStreaming">&#127908;</span> - streaming</li>\n        </ul>\n      </li>\n      <li>For Lichess: <span class="colorGreen">green</span> and <span class="colorRed">red</span> values in the rating table - are a change in the <span class="dotted">rating of the last\n          game day</span> in comparison with the <span class="dotted">rating of the previous game day</span>.\n      </li>\n    </ul>\n    </fieldset>\n\n    <fieldset id="tipsRU" class="hiddenBlock">\n    <legend><em><strong>Подсказки</strong></em></legend>\n    <ul>\n      <li><span class="click">Нажмите</span> на <span class="dotted">кнопку "↺" </span>\n        для обновления всех таблиц</li>\n        <li><span class="click">Нажмите</span> на <span class="dotted">кнопкe "↑↓"</span>, чтобы поменять порядок таблиц</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">заголовок "♞ Lichess" </span>\n        для обновления таблицы Lichess и упорядочивания ее по списку игроков</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">заголовок "♟ Chess.com" </span>\n        для обновления таблицы Chess.com и упорядочивания ее по списку игроков</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">другие заголовки </span>\n        для упорядочивания таблицы по соответствующему рейтингу</li>\n      <li>\n        <span class="click">При наведении</span> курсора мыши над <span class="dotted">именем игрока в таблице</span>:\n        появится подсказка с <span class="dotted">информацией об игроке из его профиля</span>\n      </li>\n      <li>Для Lichess отображаются несколько типов <span class="dotted">статусов игрока</span> слева от его имени в таблице:\n        <ul>\n          <li><span class="statusOnline">&#10004;</span> - онлайн</li>\n          <li><span class="statusPlaying">&#9679;</span> - сейчас играет</li>\n          <li><span class="statusStreaming">&#127908;</span> - сейчас стримит</li>\n        </ul>\n      </li>\n      <li>Для Lichess: <span class="colorGreen">зеленые</span> и <span class="colorRed">красные</span> значения в таблице рейтингов - это изменение <span class="dotted">\n          рейтинга последнего игрового дня</span> в сравнении с <span class="dotted">рейтингом предыдущего игрового дня</span>.\n      </li>\n    </ul>\n    </fieldset>\n'});const a=l.mount("#vue-mount"),r="https://lichess.org/api/user/",i="https://lichess.org/api/crosstable/",c="cors",u=new Map([["RU","Russia"],["US","United States"],["AZ","Azerbaijan"],["PL","Poland"],["FR","France"],["HU","Hungary"],["NL","Netherlands"],["AM","Armenia"],["CN","China"],["IR","Iran"],["NO","Norway"],["BY","Belarus"]]),m="@FIDE@",h="@STATUS-TEXT@",d="@STATUS-SYMBOL@",p=new Map([["player",0],["bullet",1],["blitz",2],["rapid",3],["puzzle",4],["rush",5]]);let y="",f="";const g="bovgit",C="Creator of this page :)",b=new Map([[g,C],["Thibault","Creator of Lichess.org"],["DrNykterstein","World champion\n\nMagnus Carlsen, Norway, FIDE 2882, GM"],["AvalonGamemaster","? Maxime Vachier-Lagrave, France, GM"]]),v=new Map([[g,C],["Erik","Creator of Chess.com"],["MagnusCarlsen","World champion"]]),S=[{name:"mix",lichessPlayerNames:"Thibault Zhigalko_Sergei Benefactorr Chess-Network Crest64 Challenger_Spy ShahMatKanal Shuvalov Pandochka",chessComPlayerNames:"Erik Hikaru VladDobrov ChessQueen ChessNetwork ShahMatKanal"},{name:"FIDE top",lichessPlayerNames:"DrNykterstein Alireza2003 Bombegranate AnishGiri Azerichessss AvalonGamemaster BakukaDaku87 Sergey_Karjakin Colchonero64 Vladimirovich9000",chessComPlayerNames:"MagnusCarlsen Firouzja2003 ChefsHouse FabianoCaruana LachesisQ LevonAronian AnishGiri gmwso Azerichess Grischuk Lordillidan LyonBeast Polish_fighter3000 TRadjabov Sebastian SergeyKarjakin hikaru Colchonero64"}],L=S.length;let P=S[0].name;const k=10,A=30;let w,N,I,T,B,z,E,q=[],$=!1,M="",O="",R="",x="";function H(){q.length>L?pe("#msgHintAddGroup"):de("#msgHintAddGroup");let e=document.querySelector("#elemLichessPlayerNames"),t=document.querySelector("#elemChessComPlayerNames");V(w.indexOf(P,0))?(pe("#msgHintEdit"),e.disabled=!0,t.disabled=!0,e.title="",t.title=""):(de("#msgHintEdit"),e.disabled=!1,t.disabled=!1,e.title=y,t.title=f)}function D(){return q.map((e=>e.name))}function G(){q=[];for(let e=0;e<L;e++)q.push("");F()}function F(){for(let e=0;e<L;e++)q[e]=JSON.parse(JSON.stringify(S[e]));P=q[0].name,w=D(),be(q[0].lichessPlayerNames),Se(q[0].chessComPlayerNames)}function U(e){const t=document.getElementById("group");for(let s=0;s<w.length;s++)j(t,w[s],e)}function j(e,t,s){const n=document.createElement("option");_(n,t,s),e.appendChild(n)}function _(e,t,s){e.value=t,e.innerHTML=t,e.value===s&&(e.selected=!0)}function K(e,t,s,n){_(e[t],s,n)}function Y(){const e=q.find((e=>e.name===P));e.lichessPlayerNames=a.vueLichessOrgPlayerNames,e.chessComPlayerNames=a.vueChessComPlayerNames}function V(e){return e>-1&&e<L}function J(){let e=Ce();e=void 0===e?"":e,be(e),Y()}function W(e,t){if(""===t)return;let s,n,o,l,r,i,c,u,m=function(e){const t=e?".TBodyLichess":".TBodyChessCom";return document.querySelector(t)}(e),h=m.rows.length;if(0===h)return;let d=new Array(h);for(s=0;s<h;s++)for(l=m.rows[s].cells,o=l.length,d[s]=new Array(o),n=0;n<o;n++)r=0===n?e?a.vueArLichessPlayers[s].playerName:a.vueArChessComPlayers[s].playerName:l[n].textContent,r=r.trim(),0===n?d[s][n]=r:(i=0,""!==r&&(i=parseInt(r,10),!isNaN(i)&&Number.isInteger(i)||(i=0)),d[s][n]=i);d.sort((function(e,s){let n=p.get(t);return s[n]-e[n]})),Q(e),c=".THead"+t+(e?"Lichess":"ChessCom"),r=document.querySelector(c).textContent,u=r.slice(-1),"↑"!==u&&(document.querySelector(c).textContent+="↑"),e?(M=c,R=t):(O=c,x=t);const y=[];let f,g;for(s=0;s<h;s++)for(f=0;f<h;f++)if(g=e?a.vueArLichessPlayers[f].playerName:a.vueArChessComPlayers[f].playerName,d[s][0]===g){y.push(e?a.vueArLichessPlayers[f]:a.vueArChessComPlayers[f]);break}for(s=0;s<h;s++)e?a.vueArLichessPlayers[s]=y[s]:a.vueArChessComPlayers[s]=y[s]}function Q(e){let t=e?M:O;if(""!==t){let e=document.querySelector(t).textContent;"↑"===e.slice(-1)&&(document.querySelector(t).textContent=e.slice(0,-1))}}function Z(e){Q(e),e?(M="",R=""):(O="",x="")}function X(){let e=!0;Z(e),ne(e),e=!1,Z(e),ne(e),ye()}function ee(){se(!0)}function te(){se(!1)}function se(e){Z(e),ne(e),ye()}function ne(e){const t=e?"#LichessTables":".TableChessComRatings",s=document.querySelector(t);!function(e){return e?we():Ie()}(e)?"none"!==s.style.display&&(s.style.display="none"):("block"!==s.style.display&&(s.style.display="block"),async function(e){let t=oe(e);0!==t.length&&(ze(e,!0),e?(a.vueArLichessPlayersBuf.length=0,await async function(e){await async function(e){const t=e.join(","),s=await fetch("https://lichess.org/api/users",{method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},body:t});if(!s.ok)return void $e(`status error: ${s.status} ${s.statusText} - getProfilesAfterFetchFromLichess`);const n=qe(),o=await s.json();e.forEach(((e,t)=>{const s=e.toUpperCase(),l=o.find((e=>e.username.toUpperCase()===s));if(l){let t,s=ce(0,l,"title");s=void 0===s?"":s+" ";let o="",r=b.get(e);r&&(o=r+"\n\n");const i=ue(0,l,"profile","firstName"),c=ue(0,l,"profile","lastName"),m=ue(0,l,"profile","location"),d=ue(0,l,"profile","fideRating"),p=ue(0,l,"profile","bio"),y=ue(0,l,"profile","links");let f="";if(t=ue(0,l,"profile","country"),t){f=u.get(t)||f}let g="";t=ce(0,l,"createdAt"),t&&(g=new Date(t).getFullYear());let C="";t=ce(0,l,"seenAt");let v="lastOnline";t&&(C=Ee(t),new Date(t)<n&&(v="lastOnlineBeforeToday"));const S=(i?i+" ":"")+(c||"")+(m?(i||c?", ":"")+m:"")+(f?(i||c||m?", ":"")+f:"")+(d?", FIDE "+d:"")+(s&&!r?", "+s:"");o+=S+(S?"\n":"")+(g?"reg. "+g:"")+(C?"\nlast online "+C:"")+"\n"+h+(p?"\n"+Me(p,'"',"'"):"")+(y?"\n"+y:"");let L='<a href="https://lichess.org/@/'+e+'" target="_blank" title="'+o+'">@STATUS-SYMBOL@<span class="playerTitle">'+s+" </span><strong>"+e+"</strong></a>"+(C?'<br><span class="'+v+'">'+C+"</span>":"");const P=me(0,l,"perfs","bullet","rating"),k=me(0,l,"perfs","blitz","rating"),A=me(0,l,"perfs","rapid","rating"),w=me(0,l,"perfs","puzzle","rating"),N=me(0,l,"perfs","storm","score");a.vueArLichessPlayersBuf.push({playerHTML:L,playerName:e,bullet:P,blitz:k,rapid:A,puzzle:w,rush:N})}else $e(`${e} - lichess, response.json error`),a.vueArLichessPlayersBuf.push({playerHTML:"<em>"+e+"</em>",playerName:e,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})}))}(e),await async function(e){(await async function(e){let t=[];const s=e.join(",");let n=fetch(`https://lichess.org/api/users/status?ids=${s}`,{mode:c}).then((e=>200!=e.status?null:e.json()),(e=>null));return t.push(n),await Promise.all(t)}(e))[0].forEach((t=>{const s=t.name;e.forEach(((e,n)=>{if(s.toUpperCase()===e.toUpperCase()){const e=ce(0,t,"patron"),s=ce(0,t,"online"),o=ce(0,t,"playing"),l=ce(0,t,"streaming");let r=e?"Patron. ":"";const i=Oe(),c=i?"Now":"Сейчас",u=i?"playing":"играет",m=i?"streaming":"стримит",p=i?"online":"онлайн";r+=s||l||o?c+" ":"",r+=o?u+", ":"",r+=l?m+", ":"",r+=!s||l||o?"":p+", ",r=r.trim(),","===r[r.length-1]&&(r=r.slice(0,r.length-1)+".");let y=r?r+"\n":"",f=a.vueArLichessPlayersBuf[n].playerHTML.replace(h,y);r="",l&&(r='<span class="statusStreaming">&#127908;</span>'),o&&(r+='<span class="statusPlaying">&#9679;</span>'),!s||l||o||(r='<span class="statusOnline">&#10004;</span>'),f=f.replace(d,r),a.vueArLichessPlayersBuf[n].playerHTML=f}}))}))}(e),await async function(e){(await async function(e){let t=[];for(let s of e){let e=fetch(`${r}${s}/activity`,{mode:c}).then((e=>200!=e.status?null:e.json()),(e=>null));t.push(e)}return await Promise.all(t)}(e)).forEach(((e,t)=>{if(e&&0!==e.length)for(let s of["bullet","blitz","rapid","puzzle"]){const o="bullet"===s||"blitz"===s||"rapid"===s,l=o?"games":"puzzles",r=o?s:"score",i="rp",c=e.find((e=>!!(e[l]&&e[l][r]&&e[l][r][i])));if(c){const e=c[l][r][i].after,o=c[l][r][i].before;if(e&&o){const l=e-o;if(0!==l){const e=n?"mobileRatingPlus":"ratingPlus";let o=(l>0?"+":"")+`${l}`;o=l>0?"<sup>"+o+"</sup>":"<sub>"+o+"</sub>",o=`<span class="${l>0?e:"ratingMinus"}">${o}</span>`;const r=a.vueArLichessPlayersBuf[t];r[s]=`${r[s]}${o}`,a.vueArLichessPlayersBuf[t]=r}}}}}))}(e),function(e){e.forEach(((e,t)=>{let s=a.vueArLichessPlayersBuf[t].playerHTML.replace(h,"");s=s.replace(d,""),a.vueArLichessPlayersBuf[t].playerHTML=s}))}(e)}(t)):(a.vueArChessComPlayersBuf.length=0,a.vueArChessComPlayersBuf=a.vueArChessComPlayersBuf.map(((e,t)=>{a.vueArChessComPlayersBuf[t]={playerHTML:"",playerName:"",bullet:"",blitz:"",rapid:"",puzzle:"",rush:""}})),await async function(e){let t=!0;await le(e,t),t=!1,await le(e,t)}(t)),function(e,t){if(0===t.length)return;const s=e?a.vueArLichessPlayersBuf.length:a.vueArChessComPlayersBuf.length,n=[];for(let o=0;o<t.length;o++){const l=t[o];if(""!==l)for(let t=0;t<s;t++)if(l===(e?a.vueArLichessPlayersBuf[t].playerName:a.vueArChessComPlayersBuf[t].playerName)){n.push(e?a.vueArLichessPlayersBuf[t]:a.vueArChessComPlayersBuf[t]);break}}e?a.vueArLichessPlayers=[...n]:a.vueArChessComPlayers=[...n]}(e,t),H(),ze(e,!1))}(e))}function oe(e){let t=function(e){return e?Ce():ve()}(e);t=Me(t,"\n"," ");let s=t.split(" ");return s=s.filter((e=>""!==e)),s}async function le(e,t){let s=[...e];const n=s.length;if(0===n)return;const o=t?"profile":"statistics";let l=250;for(let a=0;a<7;a++){let r=[...s];r=r.map((e=>!1)),a>0&&(l+=30,$e(`step ${a+1} / 7, chess.com ${o}, ${s.length} el. from ${n}, delay ${l}`),await new Promise(((e,t)=>setTimeout(e,l))));let i=!0;const c=t?"":"/stats";if((await ae(!1,s,c)).forEach(((n,l)=>{const a=s[l];let c=!1;t?c=re(n,a,e):null!==n&&(ie(n,e.indexOf(a),a),c=!0),c?r[l]=!0:(i=!1,$e(`not read ${o}: ${a}, chess.com`))})),i)break;s=s.filter(((e,t)=>!r[t]))}}async function ae(e,t,s=""){let n=[];for(let o of t)if(""!==o){let t=fetch(`${e?r:"https://api.chess.com/pub/player/"}${o}${s}`,{mode:c}).then((e=>200!=e.status?null:e.json()),(e=>null));n.push(t)}return await Promise.all(n)}function re(e,t,s){let n=!1,o="",l="",r="",i="",c="",h="";const d=qe();let p=v.get(t);if(p&&(h=p+"\n\n"),o=ce(0,e,"url"),""===o||null==o)r="<em>"+t+"</em>";else{p=ce(0,e,"title"),l=void 0===p?"":p+" ";let s="";if(p=ce(0,e,"country"),p){const e=p.slice(-2),t=u.get(e);t&&(s=t)}const a=ce(0,e,"name");let y=ce(0,e,"location");p=ce(0,e,"joined"),p&&(i=new Date(1e3*p).getFullYear()),p=ce(0,e,"last_online");let f="lastOnline";p&&(c=Ee(1e3*p),new Date(1e3*p)<d&&(f="lastOnlineBeforeToday")),h+=(a||"")+(y?", "+y:"")+(s?", "+s:""),h+=m+(l?", "+l:""),h+=(h&&h!==m?"\n":"")+"reg. "+i+"\nlast online "+c,r='<a href="'+o+'" target="_blank" title="'+h+'"><span class="playerTitle">'+l+" </span><strong>"+t+"</strong></a>"+(c?'<br><span class="'+f+'">'+c+"</span>":""),n=!0}return s.forEach(((e,s)=>{e===t&&(a.vueArChessComPlayersBuf[s]={playerHTML:r,playerName:t,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})})),n}function ie(e,t,s){const n=ce(0,e,"fide"),o=n?`, FIDE ${n}`:"",l=a.vueArChessComPlayersBuf[t].playerHTML.replace(m,o),r=me(0,e,"chess_bullet","last","rating"),i=me(0,e,"chess_blitz","last","rating"),c=me(0,e,"chess_rapid","last","rating"),u=me(0,e,"tactics","highest","rating"),h=me(0,e,"puzzle_rush","best","score");a.vueArChessComPlayersBuf[t]={playerHTML:l,playerName:s,bullet:r,blitz:i,rapid:c,puzzle:u,rush:h}}function ce(e,t,s){let n="";try{n=t[s]}catch(e){}return n}function ue(e,t,s,n){let o="";try{o=t[s][n]}catch(e){}return o}function me(e,t,s,n,o){let l="";try{l=t[s][n][o]}catch(e){}return l}function he(){let e=Le();if(""!==e){let t=parseInt(e,10);if(isNaN(t)||!(Number.isInteger(t)&&t>=0&&t<=9999))return void alert("Interval must be between 0 and 9999 !");e=t.toString(10)}Pe(e),localStorage.setItem("AutoRefreshInterval",e),fe(),pe(".sectionSettingsArea"),de("main")}function de(e){document.querySelector(e).style.display="block"}function pe(e){document.querySelector(e).style.display="none"}function ye(){let e,t,s;localStorage.setItem("groupObjs",JSON.stringify(q)),localStorage.setItem("currentGroupName",P),e=Ce(),s=localStorage.getItem("LichessOrgPlayerNames"),s=null===s?"":s,t=e.trim()!==s.trim(),localStorage.setItem("LichessOrgPlayerNames",e),e=ve(),s=localStorage.getItem("ChessComPlayerNames"),s=null===s?"":s,t=t||e.trim()!==s.trim(),localStorage.setItem("ChessComPlayerNames",e),e=we()?"1":"0",t=t||e!==localStorage.getItem("LichessChecked"),localStorage.setItem("LichessChecked",e),e=Ie()?"1":"0",t=t||e!==localStorage.getItem("ChessComChecked"),localStorage.setItem("ChessComChecked",e),e=ke()?"1":"0",t=t||e!==localStorage.getItem("DarkThemeChecked"),localStorage.setItem("DarkThemeChecked",e)}function fe(){clearInterval(N);let e=Le();if(""!==e){let t=parseInt(e,10);0!==t&&(N=setInterval(X,60*t*1e3))}else N=void 0}function ge(){let e;B.parentNode.insertBefore(B,T),e=T,T=B,B=e,E.parentNode.insertBefore(E,z),e=z,z=E,E=e}function Ce(){return a.vueLichessOrgPlayerNames.trim()}function be(e){a.vueLichessOrgPlayerNames=e.trim()}function ve(){return a.vueChessComPlayerNames.trim()}function Se(e){a.vueChessComPlayerNames=e.trim()}function Le(){return a.vueAutoRefreshInterval.trim()}function Pe(e){a.vueAutoRefreshInterval=e?e.trim():""}function ke(){return a.vueCheckDarkTheme}function Ae(e){a.vueCheckDarkTheme=e}function we(){return a.vueCheckLichess}function Ne(e){a.vueCheckLichess=e}function Ie(){return a.vueCheckChessCom}function Te(e){a.vueCheckChessCom=e}function Be(){const e=ke(),t="black",s="white";e?(document.body.style.backgroundColor=t,document.body.style.color=s):(document.body.style.backgroundColor=s,document.body.style.color=t);const n=e?"1":"0";localStorage.setItem("DarkThemeChecked",n)}function ze(e,t){let s,n,o,l;e&&we()&&(o=document.querySelector("#elemLichessPlayerNames"),l=document.querySelector("#buttonLichessRefresh"),s="♞ Enter",n="⌛ Enter"),!e&&Ie()&&(o=document.querySelector("#elemChessComPlayerNames"),l=document.querySelector("#buttonChessComRefresh"),s="♟ Enter",n="⌛ Enter"),o&&(l.value=t?n:s)}function Ee(e){let t=new Date;const s=new Date(t).setHours(0,0,0,0);t-=864e5;const n=new Date(t).setHours(0,0,0,0),o=new Date(e);let l=o.toLocaleString();const a=", "+[o.getHours(),o.getMinutes()].map((e=>e<10?"0"+e:e)).join(":");return o>=s?l=(Oe()?"today":"сегодня")+a:o>=n&&(l=(Oe()?"yesterday":"вчера")+a),l}function qe(){const e=new Date-864e5;return new Date(e).setHours(0,0,0,0)}function $e(e){const t=(new Date).toLocaleString();console.log(`${t} - ${e}`)}function Me(e,t,s){return e.replace(new RegExp(t,"g"),s)}function Oe(){return s===e}function Re(){let n;!function(){const n=document.getElementById("langSelect"),o=n.selectedIndex;s=-1===o||n.options[o].text===e?e:t}(),localStorage.setItem("Lang",s);const o=!(s===t);n=document.querySelector("#buttonTables"),n.value=n.title=o?"Tables":"Таблицы",n=document.querySelector("#buttonSettings"),n.value=o?"Settings":"Настройки",n.title=o?"Settings":"Настройки и подсказки",document.querySelector("#buttonRefreshAllTables").title=o?"Refresh all tables":"Обновить все таблицы",document.querySelector("#buttonChangeTables").title=o?"Change tables order":"Поменять таблицы местами",document.querySelector("#GroupText").textContent=o?"Players group: ":"Группа игроков: ",document.querySelector("#buttonGroupAdd").title=o?"Add group":"Добавить группу",document.querySelector("#buttonGroupDel").title=o?"Delete group":"Удалить группу",document.querySelector("#msgHintAddGroup").textContent=o?'Create your own players group by click "+" .':'Создайте свою группу игроков, нажав "+" .',document.querySelector("#elemCheckLichess").title=o?"Make visible or unvisible Lichess table":"Сделать видимой или невидимой таблицу Lichess",document.querySelector("#buttonLichessRefresh").title=o?"Refresh Lichess table":"Обновить таблицу Lichess",n=document.querySelector("#elemLichessPlayerNames"),y=n.title=n.placeholder=o?"Enter players on Lichess, separated by spaces or newline":"Введите Lichess-игроков через пробел или с новой строки",document.querySelector("#elemCheckChessCom").title=o?"Make visible or unvisible Chess.com table":"Сделать видимой или невидимой таблицу Chess.com",document.querySelector("#buttonChessComRefresh").title=o?"Refresh Chess.com table":"Обновить таблицу Chess.com",n=document.querySelector("#elemChessComPlayerNames"),f=n.title=n.placeholder=o?"Enter players on Chess.com, separated by spaces or newline":"Введите Chess.com-игроков через пробел или с новой строки",document.querySelector("#msgHintEdit").textContent=o?"You can edit player lists ↑":"Вы можете редактировать списки игроков ↑",document.querySelector(".THeadScoreLichess").title=o?"The score among players from this table":"Счет между игроками из этой таблицы",document.querySelector(".THeadbulletLichess").textContent=o?"bullet":"пуля",document.querySelector(".THeadblitzLichess").textContent=o?"blitz":"блиц",document.querySelector(".THeadrapidLichess").textContent=o?"rapid":"рапид",document.querySelector(".THeadpuzzleLichess").textContent=o?"puzzle":"задачи",document.querySelector(".THeadrushLichess").textContent=o?"storm":"штурм",document.querySelector(".THeadbulletChessCom").textContent=o?"bullet":"пуля",document.querySelector(".THeadblitzChessCom").textContent=o?"blitz":"блиц",document.querySelector(".THeadrapidChessCom").textContent=o?"rapid":"рапид",document.querySelector(".THeadpuzzleChessCom").textContent=o?"puzzle":"задачи",document.querySelector(".THeadrushChessCom").textContent=o?"rush":"штурм",document.querySelector("#legendSettings").textContent=o?"Settings":"Настройки",document.querySelector("#AutoRefresh").textContent=o?"AutoRefresh Interval in minutes (0 - no AutoRefresh): ":"Интервал автообновления в минутах (0 - нет автообновления): ",document.querySelector("#DarkThemeText").textContent=o?" Dark theme ":" Темная тема",n=document.querySelector("#buttonClearSettings"),n.value=n.title=o?"Clear all settings, user's groups":"Очистить все настройки, пользовательские группы",document.querySelector("#tipsEN").setAttribute("class",o?"showBlock":"hiddenBlock"),document.querySelector("#tipsRU").setAttribute("class",o?"hiddenBlock":"showBlock"),document.querySelector("#hrefEMail").title=o?"send email to bovgit@gmail.com":"отправить письмо на bovgit@gmail.com",document.querySelector("#hrefVideo").title=o?"Video-demonstration":"Видео-демонстрация"}var xe;T=document.querySelector("#InputOrder1"),B=document.querySelector("#InputOrder2"),z=document.querySelector("#LichessTables"),E=document.querySelector("#ChessComTables"),n&&(document.querySelector("#bodyStyle").setAttribute("class","mobileStyle"),document.querySelector("#modalDialog").setAttribute("class","modalDialogMobileStyle")),document.querySelector("#group").onchange=()=>function(){const e=document.getElementById("group");let t=q.find((t=>t.name===e.value));t&&(P=t.name,be(t.lichessPlayerNames),Se(t.chessComPlayerNames)),"streamers online"===P&&async function(){try{const e=await fetch("https://lichess.org/streamer/live/",{mode:c});if(e.ok){const t=await e.json();if(t){be(t.map((e=>e.name)).join(" ")),J()}}}catch(e){$e(`getStreamersOnlineAfterFetchFromLichess(), error: ${e}`)}}(),H(),X()}(),document.querySelector("#langSelect").onchange=()=>Re(),document.addEventListener("keydown",(function(e){e.ctrlKey&&"Enter"===e.key&&X()})),G(),function(){let n;n=localStorage.getItem("Lang"),s=n&&""!==n&&n!==e?t:e,document.getElementById("langSelect").value=s,Re(),n=localStorage.getItem("currentGroupName"),n||(n=P),""!==n&&(P=n),n=localStorage.getItem("groupObjs"),n&&""!==n&&"undefined"!==n?(q=JSON.parse(n),w=D(),n=localStorage.getItem("LichessOrgPlayerNames"),be(n),n=localStorage.getItem("ChessComPlayerNames"),Se(n)):(n=localStorage.getItem("LichessOrgPlayerNames"),n||(n=S[0].lichessPlayerNames),""!==n&&be(n),n=localStorage.getItem("ChessComPlayerNames"),n||(n=S[0].chessComPlayerNames),""!==n&&Se(n)),n=localStorage.getItem("LichessChecked"),n=null===n?"1":n,Ne("1"===n),n=localStorage.getItem("ChessComChecked"),n=null===n?"1":n,Te("1"===n),n=localStorage.getItem("isFirstChessCom"),$="1"===n,n=localStorage.getItem("AutoRefreshInterval"),Pe(n),n=localStorage.getItem("DarkThemeChecked"),Ae("1"===n)}(),U(P),xe=P,K(document.getElementById("group"),w.indexOf(xe,0),xe,xe),$&&ge(),fe(),Be(),window.addEventListener("orientationchange",(function(){window.orientation}),!1),I=!0,X(),H()})();