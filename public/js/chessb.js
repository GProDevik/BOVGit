(()=>{"use strict";let e="EN",t="RU",s=e;const n=!!new RegExp("ipad|iphone|android|pocket|palm|windows ce|windowsce|cellphone|opera mobi|ipod|small|sharp|sonyericsson|symbian|opera mini|nokia|htc_|samsung|motorola|smartphone|blackberry|playstation portable|tablet browser|webOS|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk","i").test(navigator.userAgent),a=document.getElementById("modalDialog");document.getElementById("modalDialogHide").onclick=()=>a.close();const l={data:()=>({vueCurrentUsername:"",vueCheckLichess:!1,vueLichessOrgPlayerNames:"",vueCheckChessCom:!1,vueChessComPlayerNames:"",vueAutoRefreshInterval:"",vueCheckDarkTheme:!1,vueArLichessPlayers:[],vueArChessComPlayers:[],vueArLichessPlayersBuf:[],vueArChessComPlayersBuf:[]}),methods:{vueScoreLichess(e){!function(e){!async function(e,t){if(-1===e.indexOf(t))return;ze(true,!0);const s=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;let n=!1,a="";const l=Math.max.apply(null,e.map((e=>e.length)));for(let o of e)if(o!==t){const e=`${c}${t}/${o}`;try{const o=await fetch(e);if(o.ok){const e=await o.json();if(e&&!e.error){let n="",o=0,r="",i=0;const c=e.users;for(let e in c)e.toUpperCase()===t.toUpperCase()?(n=e,o=c[e]):(r=e,i=c[e]);const u=o-i;let m=(u>0?"+":"")+`${u}`;0===u||s||(m=`<span class="${u>0?"scorePlus":"scoreMinus"}">${m}</span>`);const h="_".repeat(l-r.length+2);a+=s?`X - ${r} ${h} ${o} : ${i} = ${m}\n`:`${n} - ${r} ${h}   ${o} : ${i} = ${m}\n`}}else n=!0,xe(`status error: ${o.status} ${o.statusText} - ${e}`)}catch(t){n=!0,xe(`error: ${t} - ${e}`)}}let o;ze(true,!1),Me()?(a+=n?'\nLichess says: "Too many requests from your ip-address."\nTry again later.':"",o=s?`Score (X is ${t} ):`:"Score between players:"):(a+=n?'\nLichess сообщает: "Слишком много запросов с вашего ip-адреса."\nПовторите запрос немного позже.':"",o=s?`Счет (X это ${t}):`:"Счет между игроками:"),function(e="",t=""){alert((t?t+"\n\n":"")+e)}(a,o)}(le(!0),e)}(e)},vueGroupAdd(){!function(){let e,t;if(G().length===A){const e=Me()?"10 groups have already been created.\n\nThis is maximum !":"10 групп уже создано.\n\nЭто максимум !";return void alert(e)}t=Me()?"Input name of new group:":"Введите имя новой группы:";const s=prompt(t,"");if(null!==s&&""!==s){if(s.length>N)return t=Me()?"The name must not exceed 30 symbols !":"Длина имени не должна превышать 30 символов !",void alert(t);if(e=s.toUpperCase(),void 0!==E.find((t=>t.name.toUpperCase()===e)))return t=Me()?`Group "${s}" already exists.\n\nPlease enter an another name !`:`Группа "${s}" уже есть.\n\nПожалуйста, введите другое имя !`,void alert(t);if(s.includes("!"))return t=Me()?'The name must not include symbol "!".':'Имя не должно содержать символ  "!".',void alert(t);E.push({name:s,lichessPlayerNames:r.vueLichessOrgPlayerNames,chessComPlayerNames:r.vueChessComPlayerNames}),k=s,w=G(),_(document.getElementById("group"),k,k),ge(),D(),t=Me()?`It's created group "${s}"\nwith the current lists of players.\n\nChange player lists !`:`Создана группа "${s}"\nс текущими списками игроков.\n\nВнесите свои изменения в списки созданной группы!`,alert(t),function(e){r.vueLichessOrgPlayerNames=e}(be()+"\n"),document.querySelector("#elemLichessPlayerNames").focus()}}()},vueGroupDel(){!function(){let e,t=k;const s=w.indexOf(t,0);if(J(s))return e=Me()?`Group "${t}" cannot be deleted !`:`Группу "${t}" нельзя удалять !`,void alert(e);if(e=Me()?`Delete group "${t}" ?`:`Удалить группу "${t}" ?`,!confirm(e))return;const n=document.getElementById("group");n.options[s]=null,n.options[0].selected=!0,E=E.filter(((e,t,n)=>t!==s)),w=G(),k=w[0],D(),Se(E[0].lichessPlayerNames),Le(E[0].chessComPlayerNames),ee(),e=Me()?`Group "${t}" is deleted.\n\nCurrent group is "${k}".`:`Группа "${t}" удалена.\n\nТекущая группа теперь: "${k}".`,alert(e)}()},vueGoUserMode(){!function(){clearMessages(),ye("main"),pe(".sectionLoginArea");let e=localStorage.getItem("regtype");if(e=e||"","github"===e||"google"===e||"lichess"===e)document.getElementById("username").value="",document.getElementById("password").value="";else{const e=localStorage.getItem("username");document.getElementById("username").value=e||""}isUserLogged()?(document.getElementById("username").setAttribute("disabled",!0),document.getElementById("password").setAttribute("disabled",!0),pe("#buttonPostLogout"),ye("#buttonPostLogin"),ye("#buttonPostRegistration"),ye(".referToLichess")):(document.getElementById("username").removeAttribute("disabled"),document.getElementById("password").removeAttribute("disabled"),ye("#buttonPostLogout"),pe("#buttonPostLogin"),pe("#buttonPostRegistration"),pe(".referToLichess"))}()},vueRefresh(){ee()},vueOnClickCheckLichess(){Ie(!we()),te()},vueOnClickCheckChessCom(){Be(!Te()),se()},vueRefreshLichess(){te()},vueRefreshChessCom(){se()},vueOnchangeLichessPlayerNames(){X()},vueOnchangeChessComPlayerNames(){!function(){let e=ve();e=void 0===e?"":e,Le(e),Y()}()},vueGoTables(){ye(".sectionSettingsArea"),pe("main")},vueGoSetMode(){ye("main"),pe(".sectionSettingsArea")},vueSortBulletLichess(){W(!0,"bullet")},vueSortBlitzLichess(){W(!0,"blitz")},vueSortRapidLichess(){W(!0,"rapid")},vueSortPuzzleLichess(){W(!0,"puzzle")},vueSortRushLichess(){W(!0,"rush")},vueSortBulletChessCom(){W(!1,"bullet")},vueSortBlitzChessCom(){W(!1,"blitz")},vueSortRapidChessCom(){W(!1,"rapid")},vueSortPuzzleChessCom(){W(!1,"puzzle")},vueSortRushChessCom(){W(!1,"rush")},vueOnchangeAutoRefreshInterval(){!function(){let e=Pe();e=void 0===e?"":e,ke(e.trim())}()},vueOnClickSetTheme(){Ne(!Ae()),ge(),$e()},vueClearSettings(){!function(){let t;t=Me()?"All settings will be cleared.\n\nAre you sure ?":"Все настройки будут сброшены.\n\nВы уверены ?",confirm(t)&&(localStorage.clear(),ke(""),Ne(!1),F(),j(k),function(){let e=document.getElementById("group").options;for(;e.length>P;)e[e.length-1]=null}(),x&&(x=!1,Ce()),ee(),fe(),$e(),t=Me()?"All settings are cleared.":"Все настройки сброшены.",alert(t),s=e,document.getElementById("langSelect").value=s,Re())}()},vueRestoreStartGroups(){!function(){let e;e=Me()?"All Start-groups will be restored.\n\nAre you sure ?":"Во всех стартовых группах\nбудут восстановлены начальные значения.\n\nВы уверены ?",confirm(e)&&(U(),function(){const e=document.getElementById("group");for(let t=0;t<P;t++)V(e,t,w[t],k)}(),ee(),e=Me()?"All Start-groups are restored.":"Все стартовые группы восстановлены.",alert(e),de())}()},vueGoMainModeFromSettings(){de()},vueButtonChangeTables(){Ce(),function(){x=!x;const e=x?"1":"";localStorage.setItem("isFirstChessCom",e)}()},vueGoMainModeFromUser(){ye(".sectionLoginArea"),pe("main")}}},o=Vue.createApp(l);o.component("vue-component-tips",{template:'\n    <fieldset id="tipsEN" class="showBlock">\n    <legend><em><strong>Tips</strong></em></legend>\n    <ul>\n      <li><span class="click">Click</span> on the <span class="dotted">button "↺"</span>\n        to refresh all tables\n      </li>\n      <li><span class="click">Click</span> on the <span class="dotted">"↑↓" button</span> to change the order of tables</li>\n      <li><span class="click">Click</span> on the <span class="dotted">heading "♞ Lichess"</span> to refresh the\n        Lichess table and sort by player list</li>\n      <li><span class="click">Click</span> on the <span class="dotted">heading "♟ Chess.com"</span> to refresh the\n        Chess.com table and sort by player list</li>\n      <li><span class="click">Click</span> on <span class="dotted">any other heading</span> to sort by rating\n      </li>\n      <li>\n        If you <span class="click">hover the mouse over </span><span class="dotted">the player in table</span>,\n        a pop-up window will appear with an <span class="dotted">information about player</span>\n      </li>\n      <li>For Lichess: there are several types of <span class="dotted">player status</span> to the left of his\n        name in table:\n        <ul>\n          <li><span class="statusOnline">&#10004;</span> - online</li>\n          <li><span class="statusPlaying">&#9679;</span> - playing</li>\n          <li><span class="statusStreaming">&#127908;</span> - streaming</li>\n        </ul>\n      </li>\n      <li>For Lichess: <span class="colorGreen">green</span> and <span class="colorRed">red</span> values in the rating table - are a change in the <span class="dotted">rating of the last\n          game day</span> in comparison with the <span class="dotted">rating of the previous game day</span>.\n      </li>\n    </ul>\n    </fieldset>\n\n    <fieldset id="tipsRU" class="hiddenBlock">\n    <legend><em><strong>Подсказки</strong></em></legend>\n    <ul>\n      <li><span class="click">Нажмите</span> на <span class="dotted">кнопку "↺" </span>\n        для обновления всех таблиц</li>\n        <li><span class="click">Нажмите</span> на <span class="dotted">кнопкe "↑↓"</span>, чтобы поменять порядок таблиц</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">заголовок "♞ Lichess" </span>\n        для обновления таблицы Lichess и упорядочивания ее по списку игроков</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">заголовок "♟ Chess.com" </span>\n        для обновления таблицы Chess.com и упорядочивания ее по списку игроков</li>\n      <li><span class="click">Нажмите</span> на <span class="dotted">другие заголовки </span>\n        для упорядочивания таблицы по соответствующему рейтингу</li>\n      <li>\n        <span class="click">При наведении</span> курсора мыши над <span class="dotted">именем игрока в таблице</span>:\n        появится подсказка с <span class="dotted">информацией об игроке из его профиля</span>\n      </li>\n      <li>Для Lichess отображаются несколько типов <span class="dotted">статусов игрока</span> слева от его имени в таблице:\n        <ul>\n          <li><span class="statusOnline">&#10004;</span> - онлайн</li>\n          <li><span class="statusPlaying">&#9679;</span> - сейчас играет</li>\n          <li><span class="statusStreaming">&#127908;</span> - сейчас стримит</li>\n        </ul>\n      </li>\n      <li>Для Lichess: <span class="colorGreen">зеленые</span> и <span class="colorRed">красные</span> значения в таблице рейтингов - это изменение <span class="dotted">\n          рейтинга последнего игрового дня</span> в сравнении с <span class="dotted">рейтингом предыдущего игрового дня</span>.\n      </li>\n    </ul>\n    </fieldset>\n'});const r=o.mount("#vue-mount"),i="https://lichess.org/api/user/",c="https://lichess.org/api/crosstable/",u="cors",m=new Map([["RU","Russia"],["US","United States"],["AZ","Azerbaijan"],["PL","Poland"],["FR","France"],["HU","Hungary"],["NL","Netherlands"],["AM","Armenia"],["CN","China"],["IR","Iran"],["NO","Norway"],["BY","Belarus"]]),h="@FIDE@",d="@STATUS-TEXT@",p="@STATUS-SYMBOL@",y=new Map([["player",0],["bullet",1],["blitz",2],["rapid",3],["puzzle",4],["rush",5]]);let g="",f="";const C="bovgit",b="Creator of this page :)",S=new Map([[C,b],["Thibault","Creator of Lichess.org"],["DrNykterstein","World champion\n\nMagnus Carlsen, Norway, FIDE 2882, GM"],["AvalonGamemaster","? Maxime Vachier-Lagrave, France, GM"]]),v=new Map([[C,b],["Erik","Creator of Chess.com"],["MagnusCarlsen","World champion"]]),L=[{name:"mix",lichessPlayerNames:"Thibault Zhigalko_Sergei Benefactorr Chess-Network Crest64 Challenger_Spy ShahMatKanal Shuvalov Pandochka",chessComPlayerNames:"Erik Hikaru VladDobrov ChessQueen ChessNetwork ShahMatKanal"},{name:"FIDE top",lichessPlayerNames:"DrNykterstein Alireza2003 Bombegranate AnishGiri Azerichessss AvalonGamemaster BakukaDaku87 Sergey_Karjakin Colchonero64 Vladimirovich9000",chessComPlayerNames:"MagnusCarlsen Firouzja2003 ChefsHouse FabianoCaruana LachesisQ LevonAronian AnishGiri gmwso Azerichess Grischuk Lordillidan LyonBeast Polish_fighter3000 TRadjabov Sebastian SergeyKarjakin hikaru Colchonero64"}],P=L.length;let k=L[0].name;const A=10,N=30;let w,I,T,B,$,z,q,E=[],x=!1,O="",M="",R="",H="";function D(){E.length>P?ye("#msgHintAddGroup"):pe("#msgHintAddGroup");let e=document.querySelector("#elemLichessPlayerNames"),t=document.querySelector("#elemChessComPlayerNames");J(w.indexOf(k,0))?(ye("#msgHintEdit"),e.disabled=!0,t.disabled=!0,e.title="",t.title=""):(pe("#msgHintEdit"),e.disabled=!1,t.disabled=!1,e.title=g,t.title=f)}function G(){return E.map((e=>e.name))}function F(){E=[];for(let e=0;e<P;e++)E.push("");U()}function U(){for(let e=0;e<P;e++)E[e]=JSON.parse(JSON.stringify(L[e]));k=E[0].name,w=G(),Se(E[0].lichessPlayerNames),Le(E[0].chessComPlayerNames)}function j(e){const t=document.getElementById("group");for(let s=0;s<w.length;s++)_(t,w[s],e)}function _(e,t,s){const n=document.createElement("option");K(n,t,s),e.appendChild(n)}function K(e,t,s){e.value=t,e.innerHTML=t,e.value===s&&(e.selected=!0)}function V(e,t,s,n){K(e[t],s,n)}function Y(){const e=E.find((e=>e.name===k));e.lichessPlayerNames=r.vueLichessOrgPlayerNames,e.chessComPlayerNames=r.vueChessComPlayerNames}function J(e){return e>-1&&e<P}function X(){let e=be();e=void 0===e?"":e,Se(e),Y()}function W(e,t){if(""===t)return;let s,n,a,l,o,i,c,u,m=function(e){const t=e?".TBodyLichess":".TBodyChessCom";return document.querySelector(t)}(e),h=m.rows.length;if(0===h)return;let d=new Array(h);for(s=0;s<h;s++)for(l=m.rows[s].cells,a=l.length,d[s]=new Array(a),n=0;n<a;n++)o=0===n?e?r.vueArLichessPlayers[s].playerName:r.vueArChessComPlayers[s].playerName:l[n].textContent,o=o.trim(),0===n?d[s][n]=o:(i=0,""!==o&&(i=parseInt(o,10),!isNaN(i)&&Number.isInteger(i)||(i=0)),d[s][n]=i);d.sort((function(e,s){let n=y.get(t);return s[n]-e[n]})),Q(e),c=".THead"+t+(e?"Lichess":"ChessCom"),o=document.querySelector(c).textContent,u=o.slice(-1),"↑"!==u&&(document.querySelector(c).textContent+="↑"),e?(O=c,R=t):(M=c,H=t);const p=[];let g,f;for(s=0;s<h;s++)for(g=0;g<h;g++)if(f=e?r.vueArLichessPlayers[g].playerName:r.vueArChessComPlayers[g].playerName,d[s][0]===f){p.push(e?r.vueArLichessPlayers[g]:r.vueArChessComPlayers[g]);break}for(s=0;s<h;s++)e?r.vueArLichessPlayers[s]=p[s]:r.vueArChessComPlayers[s]=p[s]}function Q(e){let t=e?O:M;if(""!==t){let e=document.querySelector(t).textContent;"↑"===e.slice(-1)&&(document.querySelector(t).textContent=e.slice(0,-1))}}function Z(e){Q(e),e?(O="",R=""):(M="",H="")}function ee(){let e=!0;Z(e),ae(e),e=!1,Z(e),ae(e),ge()}function te(){ne(!0)}function se(){ne(!1)}function ne(e){Z(e),ae(e),ge()}function ae(e){const t=e?"#LichessTables":".TableChessComRatings",s=document.querySelector(t);!function(e){return e?we():Te()}(e)?"none"!==s.style.display&&(s.style.display="none"):("block"!==s.style.display&&(s.style.display="block"),async function(e){let t=le(e);0!==t.length&&(ze(e,!0),e?(r.vueArLichessPlayersBuf.length=0,await async function(e){await async function(e){const t=e.join(","),s=await fetch("https://lichess.org/api/users",{method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},body:t});if(!s.ok)return void xe(`status error: ${s.status} ${s.statusText} - getProfilesAfterFetchFromLichess`);const n=Ee(),a=await s.json();e.forEach(((e,t)=>{const s=e.toUpperCase(),l=a.find((e=>e.username.toUpperCase()===s));if(l){let t,s=ue(0,l,"title");s=void 0===s?"":s+" ";let a="",o=S.get(e);o&&(a=o+"\n\n");const i=me(0,l,"profile","firstName"),c=me(0,l,"profile","lastName"),u=me(0,l,"profile","location"),h=me(0,l,"profile","fideRating"),p=me(0,l,"profile","bio"),y=me(0,l,"profile","links");let g="";if(t=me(0,l,"profile","country"),t){g=m.get(t)||g}let f="";t=ue(0,l,"createdAt"),t&&(f=new Date(t).getFullYear());let C="";t=ue(0,l,"seenAt");let b="lastOnline";t&&(C=qe(t),new Date(t)<n&&(b="lastOnlineBeforeToday"));const v=(i?i+" ":"")+(c||"")+(u?(i||c?", ":"")+u:"")+(g?(i||c||u?", ":"")+g:"")+(h?", FIDE "+h:"")+(s&&!o?", "+s:"");a+=v+(v?"\n":"")+(f?"reg. "+f:"")+(C?"\nlast online "+C:"")+"\n"+d+(p?"\n"+Oe(p,'"',"'"):"")+(y?"\n"+y:"");let L='<a href="https://lichess.org/@/'+e+'" target="_blank" title="'+a+'">@STATUS-SYMBOL@<span class="playerTitle">'+s+" </span><strong>"+e+"</strong></a>"+(C?'<br><span class="'+b+'">'+C+"</span>":"");const P=he(0,l,"perfs","bullet","rating"),k=he(0,l,"perfs","blitz","rating"),A=he(0,l,"perfs","rapid","rating"),N=he(0,l,"perfs","puzzle","rating"),w=he(0,l,"perfs","storm","score");r.vueArLichessPlayersBuf.push({playerHTML:L,playerName:e,bullet:P,blitz:k,rapid:A,puzzle:N,rush:w})}else xe(`${e} - lichess, response.json error`),r.vueArLichessPlayersBuf.push({playerHTML:"<em>"+e+"</em>",playerName:e,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})}))}(e),await async function(e){(await async function(e){let t=[];const s=e.join(",");let n=fetch(`https://lichess.org/api/users/status?ids=${s}`,{mode:u}).then((e=>200!=e.status?null:e.json()),(e=>null));return t.push(n),await Promise.all(t)}(e))[0].forEach((t=>{const s=t.name;e.forEach(((e,n)=>{if(s.toUpperCase()===e.toUpperCase()){const e=ue(0,t,"patron"),s=ue(0,t,"online"),a=ue(0,t,"playing"),l=ue(0,t,"streaming");let o=e?"Patron. ":"";const i=Me(),c=i?"Now":"Сейчас",u=i?"playing":"играет",m=i?"streaming":"стримит",h=i?"online":"онлайн";o+=s||l||a?c+" ":"",o+=a?u+", ":"",o+=l?m+", ":"",o+=!s||l||a?"":h+", ",o=o.trim(),","===o[o.length-1]&&(o=o.slice(0,o.length-1)+".");let y=o?o+"\n":"",g=r.vueArLichessPlayersBuf[n].playerHTML.replace(d,y);o="",l&&(o='<span class="statusStreaming">&#127908;</span>'),a&&(o+='<span class="statusPlaying">&#9679;</span>'),!s||l||a||(o='<span class="statusOnline">&#10004;</span>'),g=g.replace(p,o),r.vueArLichessPlayersBuf[n].playerHTML=g}}))}))}(e),await async function(e){(await async function(e){let t=[];for(let s of e){let e=fetch(`${i}${s}/activity`,{mode:u}).then((e=>200!=e.status?null:e.json()),(e=>null));t.push(e)}return await Promise.all(t)}(e)).forEach(((e,t)=>{if(e&&0!==e.length)for(let s of["bullet","blitz","rapid","puzzle"]){const a="bullet"===s||"blitz"===s||"rapid"===s,l=a?"games":"puzzles",o=a?s:"score",i="rp",c=e.find((e=>!!(e[l]&&e[l][o]&&e[l][o][i])));if(c){const e=c[l][o][i].after,a=c[l][o][i].before;if(e&&a){const l=e-a;if(0!==l){const e=n?"mobileRatingPlus":"ratingPlus";let a=(l>0?"+":"")+`${l}`;a=l>0?"<sup>"+a+"</sup>":"<sub>"+a+"</sub>",a=`<span class="${l>0?e:"ratingMinus"}">${a}</span>`;const o=r.vueArLichessPlayersBuf[t];o[s]=`${o[s]}${a}`,r.vueArLichessPlayersBuf[t]=o}}}}}))}(e),function(e){e.forEach(((e,t)=>{let s=r.vueArLichessPlayersBuf[t].playerHTML.replace(d,"");s=s.replace(p,""),r.vueArLichessPlayersBuf[t].playerHTML=s}))}(e)}(t)):(r.vueArChessComPlayersBuf.length=0,r.vueArChessComPlayersBuf=r.vueArChessComPlayersBuf.map(((e,t)=>{r.vueArChessComPlayersBuf[t]={playerHTML:"",playerName:"",bullet:"",blitz:"",rapid:"",puzzle:"",rush:""}})),await async function(e){let t=!0;await oe(e,t),t=!1,await oe(e,t)}(t)),function(e,t){if(0===t.length)return;const s=e?r.vueArLichessPlayersBuf.length:r.vueArChessComPlayersBuf.length,n=[];for(let a=0;a<t.length;a++){const l=t[a];if(""!==l)for(let t=0;t<s;t++)if(l===(e?r.vueArLichessPlayersBuf[t].playerName:r.vueArChessComPlayersBuf[t].playerName)){n.push(e?r.vueArLichessPlayersBuf[t]:r.vueArChessComPlayersBuf[t]);break}}e?r.vueArLichessPlayers=[...n]:r.vueArChessComPlayers=[...n]}(e,t),D(),ze(e,!1))}(e))}function le(e){let t=function(e){return e?be():ve()}(e);t=Oe(t,"\n"," ");let s=t.split(" ");return s=s.filter((e=>""!==e)),s}async function oe(e,t){let s=[...e];const n=s.length;if(0===n)return;const a=t?"profile":"statistics";let l=250;for(let o=0;o<7;o++){let r=[...s];r=r.map((e=>!1)),o>0&&(l+=30,xe(`step ${o+1} / 7, chess.com ${a}, ${s.length} el. from ${n}, delay ${l}`),await new Promise(((e,t)=>setTimeout(e,l))));let i=!0;const c=t?"":"/stats";if((await re(!1,s,c)).forEach(((n,l)=>{const o=s[l];let c=!1;t?c=ie(n,o,e):null!==n&&(ce(n,e.indexOf(o),o),c=!0),c?r[l]=!0:(i=!1,xe(`not read ${a}: ${o}, chess.com`))})),i)break;s=s.filter(((e,t)=>!r[t]))}}async function re(e,t,s=""){let n=[];for(let a of t)if(""!==a){let t=fetch(`${e?i:"https://api.chess.com/pub/player/"}${a}${s}`,{mode:u}).then((e=>200!=e.status?null:e.json()),(e=>null));n.push(t)}return await Promise.all(n)}function ie(e,t,s){let n=!1,a="",l="",o="",i="",c="",u="";const d=Ee();let p=v.get(t);if(p&&(u=p+"\n\n"),a=ue(0,e,"url"),""===a||null==a)o="<em>"+t+"</em>";else{p=ue(0,e,"title"),l=void 0===p?"":p+" ";let s="";if(p=ue(0,e,"country"),p){const e=p.slice(-2),t=m.get(e);t&&(s=t)}const r=ue(0,e,"name");let y=ue(0,e,"location");p=ue(0,e,"joined"),p&&(i=new Date(1e3*p).getFullYear()),p=ue(0,e,"last_online");let g="lastOnline";p&&(c=qe(1e3*p),new Date(1e3*p)<d&&(g="lastOnlineBeforeToday")),u+=(r||"")+(y?", "+y:"")+(s?", "+s:""),u+=h+(l?", "+l:""),u+=(u&&u!==h?"\n":"")+"reg. "+i+"\nlast online "+c,o='<a href="'+a+'" target="_blank" title="'+u+'"><span class="playerTitle">'+l+" </span><strong>"+t+"</strong></a>"+(c?'<br><span class="'+g+'">'+c+"</span>":""),n=!0}return s.forEach(((e,s)=>{e===t&&(r.vueArChessComPlayersBuf[s]={playerHTML:o,playerName:t,bullet:"",blitz:"",rapid:"",puzzle:"",rush:""})})),n}function ce(e,t,s){const n=ue(0,e,"fide"),a=n?`, FIDE ${n}`:"",l=r.vueArChessComPlayersBuf[t].playerHTML.replace(h,a),o=he(0,e,"chess_bullet","last","rating"),i=he(0,e,"chess_blitz","last","rating"),c=he(0,e,"chess_rapid","last","rating"),u=he(0,e,"tactics","highest","rating"),m=he(0,e,"puzzle_rush","best","score");r.vueArChessComPlayersBuf[t]={playerHTML:l,playerName:s,bullet:o,blitz:i,rapid:c,puzzle:u,rush:m}}function ue(e,t,s){let n="";try{n=t[s]}catch(e){}return n}function me(e,t,s,n){let a="";try{a=t[s][n]}catch(e){}return a}function he(e,t,s,n,a){let l="";try{l=t[s][n][a]}catch(e){}return l}function de(){let e=Pe();if(""!==e){let t=parseInt(e,10);if(isNaN(t)||!(Number.isInteger(t)&&t>=0&&t<=9999))return void alert("Interval must be between 0 and 9999 !");e=t.toString(10)}ke(e),localStorage.setItem("AutoRefreshInterval",e),fe(),ye(".sectionSettingsArea"),pe("main")}function pe(e){document.querySelector(e).style.display="block"}function ye(e){document.querySelector(e).style.display="none"}function ge(){let e,t,s;localStorage.setItem("groupObjs",JSON.stringify(E)),localStorage.setItem("currentGroupName",k),e=be(),s=localStorage.getItem("LichessOrgPlayerNames"),s=null===s?"":s,t=e.trim()!==s.trim(),localStorage.setItem("LichessOrgPlayerNames",e),e=ve(),s=localStorage.getItem("ChessComPlayerNames"),s=null===s?"":s,t=t||e.trim()!==s.trim(),localStorage.setItem("ChessComPlayerNames",e),e=we()?"1":"0",t=t||e!==localStorage.getItem("LichessChecked"),localStorage.setItem("LichessChecked",e),e=Te()?"1":"0",t=t||e!==localStorage.getItem("ChessComChecked"),localStorage.setItem("ChessComChecked",e),e=Ae()?"1":"0",t=t||e!==localStorage.getItem("DarkThemeChecked"),localStorage.setItem("DarkThemeChecked",e)}function fe(){clearInterval(I);let e=Pe();if(""!==e){let t=parseInt(e,10);0!==t&&(I=setInterval(ee,60*t*1e3))}else I=void 0}function Ce(){let e;$.parentNode.insertBefore($,B),e=B,B=$,$=e,q.parentNode.insertBefore(q,z),e=z,z=q,q=e}function be(){return r.vueLichessOrgPlayerNames.trim()}function Se(e){r.vueLichessOrgPlayerNames=e.trim()}function ve(){return r.vueChessComPlayerNames.trim()}function Le(e){r.vueChessComPlayerNames=e.trim()}function Pe(){return r.vueAutoRefreshInterval.trim()}function ke(e){r.vueAutoRefreshInterval=e?e.trim():""}function Ae(){return r.vueCheckDarkTheme}function Ne(e){r.vueCheckDarkTheme=e}function we(){return r.vueCheckLichess}function Ie(e){r.vueCheckLichess=e}function Te(){return r.vueCheckChessCom}function Be(e){r.vueCheckChessCom=e}function $e(){const e=Ae(),t="black",s="white";e?(document.body.style.backgroundColor=t,document.body.style.color=s):(document.body.style.backgroundColor=s,document.body.style.color=t);const n=e?"1":"0";localStorage.setItem("DarkThemeChecked",n)}function ze(e,t){let s,n,a,l;e&&we()&&(a=document.querySelector("#elemLichessPlayerNames"),l=document.querySelector("#buttonLichessRefresh"),s="♞ Enter",n="⌛ Enter"),!e&&Te()&&(a=document.querySelector("#elemChessComPlayerNames"),l=document.querySelector("#buttonChessComRefresh"),s="♟ Enter",n="⌛ Enter"),a&&(l.value=t?n:s)}function qe(e){let t=new Date;const s=new Date(t).setHours(0,0,0,0);t-=864e5;const n=new Date(t).setHours(0,0,0,0),a=new Date(e);let l=a.toLocaleString();const o=", "+[a.getHours(),a.getMinutes()].map((e=>e<10?"0"+e:e)).join(":");return a>=s?l=(Me()?"today":"сегодня")+o:a>=n&&(l=(Me()?"yesterday":"вчера")+o),l}function Ee(){const e=new Date-864e5;return new Date(e).setHours(0,0,0,0)}function xe(e){const t=(new Date).toLocaleString();console.log(`${t} - ${e}`)}function Oe(e,t,s){return e.replace(new RegExp(t,"g"),s)}function Me(){return s===e}function Re(){let n;!function(){const n=document.getElementById("langSelect"),a=n.selectedIndex;s=-1===a||n.options[a].text===e?e:t}(),localStorage.setItem("Lang",s);const a=!(s===t);n=document.querySelector("#buttonTables"),n.value=n.title=a?"Tables":"Таблицы",n=document.querySelector("#buttonSettings"),n.value=a?"Settings":"Настройки",n.title=a?"Settings":"Настройки и подсказки",document.querySelector("#buttonRefreshAllTables").title=a?"Refresh all tables":"Обновить все таблицы",document.querySelector("#buttonChangeTables").title=a?"Change tables order":"Поменять таблицы местами",document.querySelector("#GroupText").textContent=a?"Players group: ":"Группа игроков: ",document.querySelector("#buttonGroupAdd").title=a?"Add group":"Добавить группу",document.querySelector("#buttonGroupDel").title=a?"Delete group":"Удалить группу",document.querySelector("#msgHintAddGroup").textContent=a?'Create your own players group by click "+" .':'Создайте свою группу игроков, нажав "+" .',document.querySelector("#elemCheckLichess").title=a?"Make visible or unvisible Lichess table":"Сделать видимой или невидимой таблицу Lichess",document.querySelector("#buttonLichessRefresh").title=a?"Refresh Lichess table":"Обновить таблицу Lichess",n=document.querySelector("#elemLichessPlayerNames"),g=n.title=n.placeholder=a?"Enter players on Lichess, separated by spaces or newline":"Введите Lichess-игроков через пробел или с новой строки",document.querySelector("#elemCheckChessCom").title=a?"Make visible or unvisible Chess.com table":"Сделать видимой или невидимой таблицу Chess.com",document.querySelector("#buttonChessComRefresh").title=a?"Refresh Chess.com table":"Обновить таблицу Chess.com",n=document.querySelector("#elemChessComPlayerNames"),f=n.title=n.placeholder=a?"Enter players on Chess.com, separated by spaces or newline":"Введите Chess.com-игроков через пробел или с новой строки",document.querySelector("#msgHintEdit").textContent=a?"You can edit player lists ↑":"Вы можете редактировать списки игроков ↑",document.querySelector(".THeadScoreLichess").title=a?"Score among players in the table":"Счет между игроками в этой таблице",document.querySelector(".THeadbulletLichess").textContent=a?"bullet":"пуля",document.querySelector(".THeadblitzLichess").textContent=a?"blitz":"блиц",document.querySelector(".THeadrapidLichess").textContent=a?"rapid":"рапид",document.querySelector(".THeadpuzzleLichess").textContent=a?"puzzle":"задачи",document.querySelector(".THeadrushLichess").textContent=a?"storm":"штурм",document.querySelector(".THeadbulletChessCom").textContent=a?"bullet":"пуля",document.querySelector(".THeadblitzChessCom").textContent=a?"blitz":"блиц",document.querySelector(".THeadrapidChessCom").textContent=a?"rapid":"рапид",document.querySelector(".THeadpuzzleChessCom").textContent=a?"puzzle":"задачи",document.querySelector(".THeadrushChessCom").textContent=a?"rush":"штурм",document.querySelector("#legendSettings").textContent=a?"Settings":"Настройки",document.querySelector("#AutoRefresh").textContent=a?"AutoRefresh Interval in minutes (0 - no AutoRefresh): ":"Интервал автообновления в минутах (0 - нет автообновления): ",document.querySelector("#DarkThemeText").textContent=a?" Dark theme ":" Темная тема",n=document.querySelector("#buttonClearSettings"),n.value=n.title=a?"Clear all settings, user's groups":"Очистить все настройки, пользовательские группы",document.querySelector("#tipsEN").setAttribute("class",a?"showBlock":"hiddenBlock"),document.querySelector("#tipsRU").setAttribute("class",a?"hiddenBlock":"showBlock"),document.querySelector("#hrefEMail").textContent=a?"(e-mail)":"(эл.почта)",document.querySelector("#hrefVideo").textContent=" "+(a?"(Video-Help)":"(Видео-Демо)")}var He;B=document.querySelector("#InputOrder1"),$=document.querySelector("#InputOrder2"),z=document.querySelector("#LichessTables"),q=document.querySelector("#ChessComTables"),n&&(document.querySelector("#bodyStyle").setAttribute("class","mobileStyle"),document.querySelector("#modalDialog").setAttribute("class","modalDialogMobileStyle")),document.querySelector("#group").onchange=()=>function(){const e=document.getElementById("group");let t=E.find((t=>t.name===e.value));t&&(k=t.name,Se(t.lichessPlayerNames),Le(t.chessComPlayerNames)),"streamers online"===k&&async function(){try{const e=await fetch("https://lichess.org/streamer/live/",{mode:u});if(e.ok){const t=await e.json();if(t){Se(t.map((e=>e.name)).join(" ")),X()}}}catch(e){xe(`getStreamersOnlineAfterFetchFromLichess(), error: ${e}`)}}(),D(),ee()}(),document.querySelector("#langSelect").onchange=()=>Re(),document.addEventListener("keydown",(function(e){e.ctrlKey&&"Enter"===e.key&&ee()})),F(),function(){let n;n=localStorage.getItem("Lang"),s=n&&""!==n&&n!==e?t:e,document.getElementById("langSelect").value=s,Re(),n=localStorage.getItem("currentGroupName"),n||(n=k),""!==n&&(k=n),n=localStorage.getItem("groupObjs"),n&&""!==n&&"undefined"!==n?(E=JSON.parse(n),w=G(),n=localStorage.getItem("LichessOrgPlayerNames"),Se(n),n=localStorage.getItem("ChessComPlayerNames"),Le(n)):(n=localStorage.getItem("LichessOrgPlayerNames"),n||(n=L[0].lichessPlayerNames),""!==n&&Se(n),n=localStorage.getItem("ChessComPlayerNames"),n||(n=L[0].chessComPlayerNames),""!==n&&Le(n)),n=localStorage.getItem("LichessChecked"),n=null===n?"1":n,Ie("1"===n),n=localStorage.getItem("ChessComChecked"),n=null===n?"1":n,Be("1"===n),n=localStorage.getItem("isFirstChessCom"),x="1"===n,n=localStorage.getItem("AutoRefreshInterval"),ke(n),n=localStorage.getItem("DarkThemeChecked"),Ne("1"===n)}(),j(k),He=k,V(document.getElementById("group"),w.indexOf(He,0),He,He),x&&Ce(),fe(),$e(),window.addEventListener("orientationchange",(function(){window.orientation}),!1),T=!0,ee(),D()})();